<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AAW Productivity Pro - Task Manager & Planner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for Light Theme */
        :root {
            /* Primary Colors */
            --primary: #4361ee;
            --primary-light: #4895ef;
            --primary-dark: #3f37c9;
            --secondary: #7209b7;
            --accent: #4cc9f0;
            
            /* Status Colors */
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #4cc9f0;
            
            /* Priority Colors */
            --priority-high: #f72585;
            --priority-medium: #f8961e;
            --priority-low: #4cc9f0;
            --priority-none: #adb5bd;
            
            /* Neutral Colors - Light Theme */
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            
            --text-primary: #212529;
            --text-secondary: #6c757d;
            --text-tertiary: #adb5bd;
            
            --border-color: #dee2e6;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --overlay-color: rgba(0, 0, 0, 0.5);
            
            /* UI Colors */
            --card-bg: #ffffff;
            --sidebar-bg: #ffffff;
            --header-bg: #ffffff;
            --input-bg: #ffffff;
            
            /* Shadows */
            --shadow: 0 8px 16px var(--shadow-color);
            --shadow-light: 0 4px 8px var(--shadow-color);
            --shadow-heavy: 0 12px 24px var(--shadow-color);
            
            /* Border Radius */
            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 24px;
            
            /* Transitions */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        /* CSS Variables for Dark Theme */
        [data-theme="dark"] {
            /* Neutral Colors - Dark Theme */
            --bg-primary: #121212;
            --bg-secondary: #1e1e1e;
            --bg-tertiary: #2d2d2d;
            
            --text-primary: #f8f9fa;
            --text-secondary: #adb5bd;
            --text-tertiary: #6c757d;
            
            --border-color: #495057;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --overlay-color: rgba(0, 0, 0, 0.7);
            
            /* UI Colors */
            --card-bg: #1e1e1e;
            --sidebar-bg: #1a1a1a;
            --header-bg: #1a1a1a;
            --input-bg: #2d2d2d;
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color var(--transition-normal), color var(--transition-normal);
        }

        /* RTL Support */
        [dir="rtl"] {
            text-align: right;
        }

        [dir="rtl"] .sidebar {
            right: 0;
            left: auto;
            border-right: none;
            border-left: 1px solid var(--border-color);
        }

        [dir="rtl"] .nav-item {
            border-left: none;
            border-right: 4px solid transparent;
        }

        [dir="rtl"] .nav-item.active {
            border-right-color: var(--primary);
        }

        [dir="rtl"] .todo-input button {
            border-radius: var(--border-radius-sm) 0 0 var(--border-radius-sm);
        }

        [dir="rtl"] .todo-input input {
            border-radius: 0 var(--border-radius-sm) var(--border-radius-sm) 0;
        }

        [dir="rtl"] .header-actions {
            flex-direction: row-reverse;
        }

        [dir="rtl"] .motivation-quote {
            border-left: none;
            border-right: 4px solid var(--primary);
            padding-left: 0;
            padding-right: 20px;
        }

        [dir="rtl"] .motivation-author {
            text-align: left;
        }

        [dir="rtl"] .calendar-nav button:first-child {
            order: 3;
        }

        [dir="rtl"] .calendar-nav button:last-child {
            order: 1;
        }

        [dir="rtl"] .todo-checkbox {
            margin-left: 10px;
            margin-right: 0;
        }

        [dir="rtl"] .nav-item i {
            margin-right: 0;
            margin-left: 12px;
        }

        [dir="rtl"] .user-avatar {
            margin-right: 0;
            margin-left: 12px;
        }

        [dir="rtl"] .logo h2 {
            margin-left: 0;
            margin-right: 10px;
        }

        [dir="rtl"] .todo-actions {
            flex-direction: row-reverse;
        }

        [dir="rtl"] .file-item i {
            margin-right: 0;
            margin-left: 8px;
        }

        [dir="rtl"] .clear-btn i {
            margin-right: 0;
            margin-left: 12px;
        }

        [dir="rtl"] .settings-nav-item i {
            margin-right: 0;
            margin-left: 12px;
        }

        /* Container */
        .container {
            display: flex;
            min-height: 100vh;
            transition: margin var(--transition-normal);
        }

        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100vh;
            background-color: var(--sidebar-bg);
            box-shadow: var(--shadow-heavy);
            z-index: 2000;
            transition: right var(--transition-normal);
            border-left: 1px solid var(--border-color);
        }

        .settings-panel.show {
            right: 0;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background-color: var(--primary);
            color: white;
        }

        .settings-header h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
        }

        .close-settings {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            border-radius: var(--border-radius-sm);
        }

        .close-settings:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .settings-content {
            padding: 20px;
            overflow-y: auto;
            height: calc(100vh - 70px);
        }

        .setting-item {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .setting-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .setting-item h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .theme-buttons,
        .language-buttons,
        .view-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .theme-btn,
        .lang-btn,
        .view-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 15px 10px;
            background-color: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            color: var(--text-secondary);
        }

        .theme-btn i,
        .lang-btn i,
        .view-btn i {
            font-size: 20px;
        }

        .theme-btn:hover,
        .lang-btn:hover,
        .view-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .theme-btn.active,
        .lang-btn.active,
        .view-btn.active {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: var(--transition-normal);
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition-normal);
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        /* Mobile Header */
        .mobile-header {
            display: none;
            background-color: var(--header-bg);
            padding: 15px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: var(--shadow-light);
            align-items: center;
            justify-content: space-between;
            height: 60px;
            border-bottom: 1px solid var(--border-color);
        }

        .mobile-menu-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--primary);
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color var(--transition-fast);
        }

        .mobile-menu-btn:hover {
            background-color: var(--bg-secondary);
        }

        .mobile-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mobile-logo i {
            color: var(--primary);
            font-size: 24px;
        }

        .mobile-logo h2 {
            color: var(--primary);
            font-size: 18px;
            font-weight: 700;
        }

        .mobile-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .mobile-settings-btn {
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }

        .mobile-settings-btn:hover {
            color: var(--primary);
            background-color: var(--bg-secondary);
        }

        .mobile-date {
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
        }

        /* Mobile Navigation Bar */
        .mobile-nav {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--header-bg);
            box-shadow: 0 -4px 12px var(--shadow-color);
            z-index: 1000;
            padding: 10px 0;
            border-top: 1px solid var(--border-color);
        }

        .mobile-nav-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: var(--text-secondary);
            padding: 8px 5px;
            transition: all var(--transition-fast);
            font-size: 12px;
            border-radius: var(--border-radius-sm);
            margin: 0 5px;
        }

        .mobile-nav-item i {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .mobile-nav-item.active {
            color: var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
        }

        .mobile-nav-item:hover {
            color: var(--primary);
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 25px 0;
            display: flex;
            flex-direction: column;
            z-index: 10;
            position: relative;
            transition: width var(--transition-normal);
        }

        .logo {
            display: flex;
            align-items: center;
            padding: 0 25px 30px 25px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 25px;
        }

        .logo h2 {
            color: var(--primary);
            font-weight: 700;
            font-size: 24px;
            margin-left: 10px;
        }

        .logo i {
            color: var(--primary);
            font-size: 28px;
        }

        .nav-menu {
            flex-grow: 1;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: var(--text-primary);
            text-decoration: none;
            transition: all var(--transition-fast);
            border-left: 4px solid transparent;
        }

        .nav-item:hover, .nav-item.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-item i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .settings-nav-item {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            border-left: 4px solid transparent;
            margin-top: 10px;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        .settings-nav-item:hover {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .settings-nav-item i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .user-info {
            padding: 20px 25px;
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 12px;
        }

        .user-details h4 {
            font-size: 16px;
            margin-bottom: 2px;
            color: var(--text-primary);
        }

        .user-details p {
            font-size: 13px;
            color: var(--text-secondary);
        }

        /* Main Content */
        .main-content {
            flex-grow: 1;
            padding: 30px;
            overflow-y: auto;
            width: 100%;
            background-color: var(--bg-primary);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header-left h1 {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 28px;
            margin-bottom: 5px;
        }

        .date-display {
            color: var(--text-secondary);
            font-size: 18px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 14px;
        }

        .header-btn:hover {
            background-color: var(--bg-tertiary);
            color: var(--primary);
            border-color: var(--primary);
        }

        .header-btn i {
            font-size: 16px;
        }

        .settings-btn {
            background-color: var(--primary);
            color: white;
            border: none;
        }

        .settings-btn:hover {
            background-color: var(--primary-dark);
            color: white;
        }

        /* Welcome Message */
        .welcome-message {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-radius: var(--border-radius-lg);
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .welcome-message h2 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .welcome-message p {
            font-size: 16px;
            opacity: 0.9;
        }

        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            transition: transform var(--transition-normal), box-shadow var(--transition-normal);
            border: 1px solid var(--border-color);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .card h3 {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card-number {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
        }

        .card-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 24px;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content.active {
            display: block;
        }

        /* Calendar */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .calendar-header h2 {
            font-size: 22px;
            color: var(--text-primary);
        }

        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .calendar-nav button {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            color: var(--text-secondary);
        }

        .calendar-nav button:hover {
            background-color: var(--bg-secondary);
            border-color: var(--primary);
            color: var(--primary);
        }

        .calendar-nav #todayBtn {
            width: auto;
            padding: 0 15px;
            font-weight: 500;
        }

        /* Calendar Grid Styles */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: var(--border-color);
            border-radius: var(--border-radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-light);
        }

        .calendar-day-header {
            background-color: var(--primary);
            color: white;
            text-align: center;
            padding: 15px 5px;
            font-weight: 600;
            font-size: 14px;
        }

        .calendar-day {
            background-color: var(--card-bg);
            min-height: 120px;
            padding: 10px;
            position: relative;
            transition: all var(--transition-fast);
            border: 1px solid var(--border-color);
        }

        .calendar-day:hover {
            background-color: var(--bg-secondary);
        }

        .calendar-day.today {
            background-color: rgba(67, 97, 238, 0.1);
            border: 2px solid var(--primary);
        }

        .day-number {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .calendar-event {
            background-color: var(--primary-light);
            color: white;
            font-size: 11px;
            padding: 3px 6px;
            border-radius: var(--border-radius-sm);
            margin-bottom: 3px;
            cursor: pointer;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            transition: background-color var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .calendar-event:hover {
            background-color: var(--primary);
        }

        .calendar-event-time {
            font-size: 9px;
            opacity: 0.9;
            margin-left: 4px;
        }

        .calendar-event-reminder {
            font-size: 9px;
            opacity: 0.8;
            margin-left: 4px;
        }

        .task-number {
            font-weight: bold;
            margin-right: 4px;
        }

        /* NEW: Calendar Week View for Mobile */
        .calendar-week-view {
            display: none;
        }

        .calendar-week-day {
            min-width: 100px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            padding: 10px;
            flex-shrink: 0;
            background-color: var(--card-bg);
        }

        .calendar-week-day.today {
            border: 2px solid var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
        }

        .calendar-week-day .day-number {
            text-align: center;
            margin-bottom: 15px;
        }

        /* To-Do List */
        .todo-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .todo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .todo-header h2 {
            font-size: 22px;
            color: var(--text-primary);
        }

        .todo-input {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
        }

        .todo-input input {
            flex-grow: 1;
            padding: 15px 20px;
            background-color: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 16px;
            transition: all var(--transition-fast);
            color: var(--text-primary);
        }

        .todo-input input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .todo-input button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 0 25px;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            min-width: 60px;
            font-size: 18px;
        }

        .todo-input button:hover {
            background-color: var(--primary-dark);
        }

        .todo-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 20px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 14px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .filter-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .filter-btn:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        .todo-list {
            list-style: none;
        }

        .todo-item {
            display: flex;
            align-items: center;
            padding: 18px;
            border-bottom: 1px solid var(--border-color);
            transition: all var(--transition-fast);
            gap: 15px;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            position: relative;
        }

        .todo-item:hover {
            background-color: var(--bg-tertiary);
            transform: translateX(5px);
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            color: var(--text-tertiary);
        }

        .todo-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
            flex-shrink: 0;
            accent-color: var(--primary);
        }

        .todo-text {
            flex-grow: 1;
            font-size: 16px;
            color: var(--text-primary);
            word-break: break-word;
            line-height: 1.5;
        }

        .todo-actions {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .todo-actions button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 16px;
            transition: all var(--transition-fast);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .todo-actions button:hover {
            color: var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
        }

        /* Priority Color Labels */
        .priority-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .priority-high {
            background-color: var(--priority-high);
        }

        .priority-medium {
            background-color: var(--priority-medium);
        }

        .priority-low {
            background-color: var(--priority-low);
        }

        .priority-none {
            background-color: var(--priority-none);
        }

        .task-project-link {
            font-size: 12px;
            color: var(--text-secondary);
            background-color: rgba(67, 97, 238, 0.1);
            padding: 3px 8px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            margin-left: 10px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .task-project-link:hover {
            background-color: rgba(67, 97, 238, 0.2);
            color: var(--primary);
        }

        /* Project Manager */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }

        .project-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            transition: all var(--transition-normal);
            position: relative;
            border: 1px solid var(--border-color);
        }

        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 15px;
        }

        .project-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-primary);
            flex-grow: 1;
            word-break: break-word;
        }

        .project-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            flex-shrink: 0;
        }

        .project-status.active {
            background-color: rgba(76, 201, 240, 0.15);
            color: var(--success);
        }

        .project-status.completed {
            background-color: rgba(40, 167, 69, 0.15);
            color: #28a745;
        }

        .project-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
            word-break: break-word;
        }

        .project-files {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .file-item {
            display: flex;
            align-items: center;
            background-color: var(--bg-secondary);
            padding: 8px 12px;
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            max-width: 100%;
            border: 1px solid var(--border-color);
        }

        .file-item i {
            margin-right: 8px;
            color: var(--primary);
            flex-shrink: 0;
        }

        .file-item span {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .file-upload {
            margin-top: 20px;
            padding: 20px;
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius-lg);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-fast);
            background-color: var(--bg-secondary);
        }

        .file-upload:hover {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .file-upload input {
            display: none;
        }

        /* Project Tasks List */
        .project-tasks {
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        .project-tasks h4 {
            margin-bottom: 15px;
            color: var(--text-primary);
            font-size: 16px;
        }

        .project-task-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            margin-bottom: 8px;
            gap: 10px;
        }

        .project-task-item.completed {
            opacity: 0.7;
        }

        /* Procrastination Fighter */
        .procrastination-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }

        .timer-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-light);
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .timer-card h2 {
            font-size: 24px;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .timer-card p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            font-size: 16px;
        }

        .timer-display {
            font-size: 72px;
            font-weight: 700;
            color: var(--primary);
            margin: 30px 0;
            font-family: 'Roboto', monospace;
            letter-spacing: 2px;
            text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .timer-controls button {
            padding: 14px 28px;
            border: none;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            min-width: 100px;
            font-size: 16px;
        }

        .btn-start {
            background-color: var(--success);
            color: white;
        }

        .btn-start:hover {
            background-color: #3aa8d0;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 201, 240, 0.3);
        }

        .btn-pause {
            background-color: var(--warning);
            color: white;
        }

        .btn-pause:hover {
            background-color: #e0871b;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(248, 150, 30, 0.3);
        }

        .btn-reset {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-reset:hover {
            background-color: var(--text-tertiary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-light);
        }

        .timer-presets {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .timer-preset {
            padding: 10px 20px;
            background-color: rgba(67, 97, 238, 0.1);
            border: 1px solid rgba(67, 97, 238, 0.3);
            border-radius: 20px;
            color: var(--primary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 500;
            font-size: 14px;
        }

        .timer-preset:hover {
            background-color: rgba(67, 97, 238, 0.2);
            transform: translateY(-2px);
        }

        .motivation-card {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 30px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .motivation-card h3 {
            margin-bottom: 20px;
            color: var(--text-primary);
            font-size: 24px;
        }

        .motivation-quote {
            font-size: 20px;
            font-style: italic;
            margin-bottom: 25px;
            padding-left: 20px;
            border-left: 4px solid var(--primary);
            line-height: 1.6;
            color: var(--text-primary);
        }

        .motivation-author {
            text-align: right;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 16px;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 14px 28px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius-md);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            text-decoration: none;
            border: 2px solid transparent;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(67, 97, 238, 0.3);
        }

        .btn-secondary {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background-color: var(--text-tertiary);
        }

        .btn-danger {
            background-color: var(--danger);
        }

        .btn-danger:hover {
            background-color: #e11575;
        }

        /* Clear Data Button */
        .clear-btn {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: var(--danger);
            text-decoration: none;
            transition: all var(--transition-fast);
            border-left: 4px solid transparent;
            cursor: pointer;
            margin-top: 10px;
        }

        .clear-btn:hover {
            background-color: rgba(247, 37, 133, 0.05);
            border-left-color: var(--danger);
        }

        .clear-btn i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* Edit Modals */
        .edit-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--overlay-color);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .edit-modal .modal-content {
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px;
            border-radius: var(--border-radius-sm);
        }

        .close-modal:hover {
            background-color: var(--bg-secondary);
        }

        /* Edit Form Styles */
        .edit-form {
            display: none;
            padding: 20px;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius-md);
            margin-top: 15px;
        }

        .edit-form.show {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-primary);
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px 15px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .form-actions .btn {
            flex: 1;
        }

        /* View Mode Simulation */
        body[data-view="mobile"] {
            max-width: 768px;
            margin: 0 auto;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
        }

        body[data-view="desktop"] .mobile-header,
        body[data-view="desktop"] .mobile-nav {
            display: none !important;
        }

        body[data-view="desktop"] .sidebar {
            display: flex;
        }

        body[data-view="desktop"] .header {
            display: flex;
        }

        /* NEW: Daily Planner Styles */
        .planner-container {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 25px;
        }

        .planner-sidebar {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .planner-day-selector {
            margin-bottom: 25px;
        }

        .planner-day-selector input {
            width: 100%;
            padding: 12px;
            background-color: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 16px;
            color: var(--text-primary);
        }

        .planner-daily-goals {
            margin-bottom: 25px;
        }

        .planner-daily-goals textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            background-color: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 14px;
            color: var(--text-primary);
            resize: vertical;
        }

        .planner-main {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .time-block-container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .time-blocks {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .time-block {
            display: grid;
            grid-template-columns: 100px 1fr 80px;
            gap: 15px;
            align-items: center;
            padding: 15px;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--border-color);
            transition: all var(--transition-fast);
        }

        .time-block-time {
            font-weight: 600;
            color: var(--text-primary);
        }

        .time-block-task {
            flex-grow: 1;
        }

        .time-block-task input {
            width: 100%;
            padding: 10px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
        }

        .time-block-status {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--danger);
        }

        .status-dot.completed {
            background-color: var(--success);
        }

        .status-dot.in-progress {
            background-color: var(--warning);
        }

        .time-block-actions {
            display: flex;
            gap: 5px;
        }

        .time-block-actions button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px;
            border-radius: var(--border-radius-sm);
            transition: all var(--transition-fast);
        }

        .time-block-actions button:hover {
            background-color: var(--bg-tertiary);
            color: var(--primary);
        }

        .time-block-actions .delete-time-block:hover {
            color: var(--danger);
            background-color: rgba(247, 37, 133, 0.1);
        }

        .planner-tasks {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .planner-tasks-list {
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        /* Active Time Block Animation */
        .time-block.active {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(67, 97, 238, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(67, 97, 238, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(67, 97, 238, 0);
            }
        }

        /* NEW: Habit Tracker with Edit/Delete */
        .productivity-tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .habit-tracker {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .habit-tracker-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .habit-day {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .habit-checkbox {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }

        .habit-checkbox.checked {
            background-color: var(--success);
            border-color: var(--success);
            color: white;
        }

        .habit-checkbox:hover {
            transform: scale(1.1);
        }

        /* Habit item with delete button */
        .habit-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background-color: var(--bg-secondary);
            border-radius: var(--border-radius-sm);
            margin-bottom: 10px;
            transition: all var(--transition-fast);
        }

        .habit-item:hover {
            background-color: var(--bg-tertiary);
        }

        .habit-item-name {
            flex-grow: 1;
            font-weight: 500;
            cursor: pointer;
            padding: 5px;
            border-radius: var(--border-radius-sm);
            transition: all var(--transition-fast);
        }

        .habit-item-name:hover {
            background-color: var(--input-bg);
        }

        .habit-item-actions {
            display: flex;
            gap: 5px;
        }

        .habit-item-actions button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 5px;
            border-radius: var(--border-radius-sm);
            transition: all var(--transition-fast);
        }

        .habit-item-actions button:hover {
            color: var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
        }

        .habit-item-actions .delete-btn:hover {
            color: var(--danger);
            background-color: rgba(247, 37, 133, 0.1);
        }

        .quick-notes {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .quick-notes textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            background-color: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-md);
            font-size: 14px;
            color: var(--text-primary);
            resize: vertical;
        }

        /* NEW: Enhanced Eisenhower Matrix with Edit/Delete */
        .priority-matrix {
            background-color: var(--card-bg);
            border-radius: var(--border-radius-lg);
            padding: 25px;
            box-shadow: var(--shadow-light);
            border: 1px solid var(--border-color);
        }

        .matrix-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        .matrix-quadrant {
            padding: 15px;
            border-radius: var(--border-radius-md);
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        .quadrant-1 {
            background-color: rgba(247, 37, 133, 0.1);
            border: 1px solid rgba(247, 37, 133, 0.3);
        }

        .quadrant-2 {
            background-color: rgba(248, 150, 30, 0.1);
            border: 1px solid rgba(248, 150, 30, 0.3);
        }

        .quadrant-3 {
            background-color: rgba(76, 201, 240, 0.1);
            border: 1px solid rgba(76, 201, 240, 0.3);
        }

        .quadrant-4 {
            background-color: rgba(173, 181, 189, 0.1);
            border: 1px solid rgba(173, 181, 189, 0.3);
        }

        .matrix-quadrant h5 {
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .matrix-quadrant h5 span {
            font-size: 12px;
            color: var(--text-secondary);
            background-color: rgba(255, 255, 255, 0.5);
            padding: 2px 8px;
            border-radius: 10px;
        }

        .matrix-items {
            flex-grow: 1;
            min-height: 150px;
            overflow-y: auto;
        }

        .matrix-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 10px;
            background-color: var(--bg-primary);
            border-radius: var(--border-radius-sm);
            margin-bottom: 5px;
            cursor: move;
            font-size: 12px;
            transition: all var(--transition-fast);
            border: 1px solid var(--border-color);
        }

        .matrix-item:hover {
            transform: translateX(3px);
            box-shadow: var(--shadow-light);
        }

        .matrix-item-text {
            flex-grow: 1;
            cursor: pointer;
            padding: 2px 5px;
            border-radius: var(--border-radius-sm);
            transition: background-color var(--transition-fast);
        }

        .matrix-item-text:hover {
            background-color: var(--bg-secondary);
        }

        .matrix-item-actions {
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity var(--transition-fast);
        }

        .matrix-item:hover .matrix-item-actions {
            opacity: 1;
        }

        .matrix-item-actions button {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 12px;
            padding: 2px 5px;
            border-radius: var(--border-radius-sm);
            transition: all var(--transition-fast);
        }

        .matrix-item-actions button:hover {
            color: var(--primary);
            background-color: rgba(67, 97, 238, 0.1);
        }

        .matrix-item-actions .delete-btn:hover {
            color: var(--danger);
            background-color: rgba(247, 37, 133, 0.1);
        }

        /* Matrix Add Form */
        .matrix-add-form {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .matrix-add-form input {
            flex-grow: 1;
            padding: 8px 12px;
            background-color: var(--input-bg);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 12px;
            color: var(--text-primary);
        }

        .matrix-add-form button {
            padding: 8px 15px;
            font-size: 12px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .matrix-add-form button:hover {
            background-color: var(--primary-dark);
        }

        /* Habit Edit/Delete Buttons */
        .habit-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .habit-actions .btn {
            flex: 1;
            padding: 10px;
            font-size: 14px;
        }

        /* Project Delete Button */
        .project-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .project-actions .btn {
            flex: 1;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--card-bg);
            border-left: 4px solid var(--primary);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-heavy);
            z-index: 9999;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            max-width: 300px;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast-success {
            border-left-color: var(--success);
        }
        
        .toast-error {
            border-left-color: var(--danger);
        }
        
        .toast-warning {
            border-left-color: var(--warning);
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }
        
        .empty-state i {
            font-size: 48px;
            margin-bottom: 15px;
            color: var(--text-tertiary);
        }
        
        /* Calendar Event Form */
        .calendar-event-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .calendar-event-form input,
        .calendar-event-form select {
            padding: 12px 15px;
            background-color: var(--input-bg);
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            font-size: 14px;
            color: var(--text-primary);
            min-width: 120px;
        }
        
        .calendar-event-form input:focus,
        .calendar-event-form select:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .event-time-input {
            width: 100px;
        }
        
        .event-reminder-select {
            width: 140px;
        }
        
        .event-actions {
            display: flex;
            gap: 10px;
        }
        
        .task-counter {
            display: inline-block;
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
            font-size: 12px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 5px;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .procrastination-container {
                grid-template-columns: 1fr;
            }
            
            .projects-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
            
            .planner-container {
                grid-template-columns: 1fr;
            }
            
            .productivity-tools-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 60px;
                padding-bottom: 70px;
            }
            
            body:not([data-view="desktop"]) .container {
                flex-direction: column;
            }
            
            body:not([data-view="desktop"]) .sidebar {
                display: none;
                position: fixed;
                top: 60px;
                left: 0;
                bottom: 70px;
                width: 280px;
                z-index: 999;
                transform: translateX(-100%);
                transition: transform var(--transition-normal);
                box-shadow: var(--shadow-heavy);
            }
            
            body:not([data-view="desktop"]) .sidebar.show {
                display: flex;
                transform: translateX(0);
            }
            
            body:not([data-view="desktop"]) .header {
                display: none;
            }
            
            body:not([data-view="desktop"]) .mobile-header {
                display: flex;
            }
            
            body:not([data-view="desktop"]) .mobile-nav {
                display: flex;
            }
            
            .main-content {
                padding: 15px;
            }
            
            .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .timer-display {
                font-size: 56px;
            }
            
            .settings-panel {
                width: 100%;
                right: -100%;
            }
            
            .edit-modal .modal-content {
                width: 95%;
            }
            
            .sidebar-overlay {
                position: fixed;
                top: 60px;
                left: 0;
                right: 0;
                bottom: 70px;
                background: var(--overlay-color);
                z-index: 998;
                display: block;
            }
            
            .calendar-grid {
                display: none !important;
            }
            
            .calendar-week-view {
                display: flex !important;
                flex-direction: row;
                overflow-x: auto;
                gap: 8px;
                padding: 10px 0;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
            }
            
            .calendar-week-day {
                min-width: 120px;
                scroll-snap-align: start;
                height: 180px;
                overflow-y: auto;
            }
            
            .calendar-day {
                min-height: 100px;
            }
            
            .time-block {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .matrix-grid {
                grid-template-columns: 1fr;
            }
            
            /* Desktop view on mobile */
            body[data-view="desktop"] .container {
                flex-direction: row;
            }
            
            body[data-view="desktop"] .sidebar {
                display: flex;
                width: 60px;
                transition: width var(--transition-normal);
                overflow: hidden;
            }
            
            body[data-view="desktop"] .sidebar:hover {
                width: 260px;
            }
            
            body[data-view="desktop"] .sidebar .logo h2,
            body[data-view="desktop"] .sidebar .nav-item span,
            body[data-view="desktop"] .sidebar .settings-nav-item span,
            body[data-view="desktop"] .sidebar .clear-btn span,
            body[data-view="desktop"] .sidebar .user-details {
                opacity: 0;
                transition: opacity var(--transition-normal);
            }
            
            body[data-view="desktop"] .sidebar:hover .logo h2,
            body[data-view="desktop"] .sidebar:hover .nav-item span,
            body[data-view="desktop"] .sidebar:hover .settings-nav-item span,
            body[data-view="desktop"] .sidebar:hover .clear-btn span,
            body[data-view="desktop"] .sidebar:hover .user-details {
                opacity: 1;
            }
            
            body[data-view="desktop"] .main-content {
                padding: 20px;
                width: calc(100% - 60px);
            }
            
            body[data-view="desktop"] .mobile-header,
            body[data-view="desktop"] .mobile-nav {
                display: none !important;
            }
            
            body[data-view="desktop"] .header {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
            }
            
            body[data-view="desktop"] .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            /* Adjust calendar for desktop view on mobile */
            body[data-view="desktop"] .calendar-grid {
                display: grid !important;
                grid-template-columns: repeat(7, 1fr);
                overflow: visible;
            }
            
            body[data-view="desktop"] .calendar-week-view {
                display: none !important;
            }
            
            /* Adjust planner for mobile desktop view */
            body[data-view="desktop"] .planner-container {
                grid-template-columns: 250px 1fr;
                gap: 15px;
            }
            
            body[data-view="desktop"] .time-block {
                grid-template-columns: 80px 1fr 60px;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
            
            .calendar-day {
                min-height: 80px;
            }
            
            .timer-display {
                font-size: 48px;
            }
            
            .timer-controls button {
                padding: 12px 20px;
                min-width: 80px;
            }
            
            .theme-buttons,
            .language-buttons,
            .view-buttons {
                grid-template-columns: 1fr;
            }
            
            .todo-input {
                flex-wrap: wrap;
            }
            
            .todo-input select {
                min-width: 120px;
            }
            
            .calendar-event-form {
                flex-wrap: wrap;
            }
            
            .calendar-event-form input,
            .calendar-event-form select {
                flex: 1 1 100%;
            }
            
            .project-actions {
                flex-direction: column;
            }
            
            .habit-item-actions,
            .matrix-item-actions {
                opacity: 1;
            }
            
            .calendar-week-day {
                min-width: 100px;
            }
            
            body[data-view="desktop"] .planner-container {
                grid-template-columns: 1fr;
            }
            
            body[data-view="desktop"] .time-block {
                grid-template-columns: 1fr;
            }
        }

        @media (min-width: 769px) {
            body[data-view="mobile"] .sidebar {
                display: none;
            }
            
            body[data-view="mobile"] .header {
                display: none;
            }
            
            body[data-view="mobile"] .mobile-header {
                display: flex;
            }
            
            body[data-view="mobile"] .mobile-nav {
                display: flex;
            }
            
            body[data-view="mobile"] .main-content {
                margin-top: 60px;
                margin-bottom: 70px;
            }
        }
    </style>
</head>
<body>
    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-header">
            <h3><i class="fas fa-cog"></i> <span data-i18n="settings">Settings</span></h3>
            <button class="close-settings" id="closeSettings"><i class="fas fa-times"></i></button>
        </div>
        <div class="settings-content">
            <div class="setting-item">
                <h4><i class="fas fa-palette"></i> <span data-i18n="theme">Theme</span></h4>
                <div class="theme-buttons">
                    <button class="theme-btn active" data-theme="light">
                        <i class="fas fa-sun"></i>
                        <span data-i18n="light">Light</span>
                    </button>
                    <button class="theme-btn" data-theme="dark">
                        <i class="fas fa-moon"></i>
                        <span data-i18n="dark">Dark</span>
                    </button>
                    <button class="theme-btn" data-theme="auto">
                        <i class="fas fa-adjust"></i>
                        <span data-i18n="auto">Auto</span>
                    </button>
                </div>
            </div>
            
            <div class="setting-item">
                <h4><i class="fas fa-language"></i> <span data-i18n="language">Language</span></h4>
                <div class="language-buttons">
                    <button class="lang-btn active" data-lang="en">
                        <i class="fas fa-globe"></i>
                        <span>English</span>
                    </button>
                    <button class="lang-btn" data-lang="ar">
                        <i class="fas fa-globe"></i>
                        <span></span>
                    </button>
                </div>
            </div>
            
            <div class="setting-item">
                <h4><i class="fas fa-desktop"></i> <span data-i18n="viewMode">View Mode</span></h4>
                <div class="view-buttons">
                    <button class="view-btn active" data-view="auto">
                        <i class="fas fa-mobile-alt"></i>
                        <span data-i18n="auto">Auto</span>
                    </button>
                    <button class="view-btn" data-view="mobile">
                        <i class="fas fa-mobile-alt"></i>
                        <span data-i18n="mobile">Mobile</span>
                    </button>
                    <button class="view-btn" data-view="desktop">
                        <i class="fas fa-desktop"></i>
                        <span data-i18n="desktop">Desktop</span>
                    </button>
                </div>
            </div>
            
            <div class="setting-item">
                <h4><i class="fas fa-bell"></i> <span data-i18n="notifications">Notifications</span></h4>
                <div class="toggle-switch">
                    <input type="checkbox" id="notificationsToggle" checked>
                    <label for="notificationsToggle" class="toggle-slider"></label>
                </div>
            </div>
            
            <div class="setting-item">
                <h4><i class="fas fa-database"></i> <span data-i18n="dataManagement">Data Management</span></h4>
                <button class="btn btn-danger" id="exportDataBtn">
                    <i class="fas fa-download"></i> <span data-i18n="exportData">Export Data</span>
                </button>
                <button class="btn btn-secondary" id="importDataBtn">
                    <i class="fas fa-upload"></i> <span data-i18n="importData">Import Data</span>
                </button>
                <input type="file" id="importFileInput" accept=".json" style="display: none;">
            </div>
        </div>
    </div>

    <!-- Task Edit Modal -->
    <div class="edit-modal" id="taskEditModal">
        <div class="todo-container modal-content">
            <div class="todo-header">
                <h2 id="editModalTitle">Edit Task</h2>
                <button class="close-modal" id="closeTaskModal"></button>
            </div>
            <form id="taskEditForm">
                <div class="form-group">
                    <label for="editTaskText">Task Description</label>
                    <input type="text" id="editTaskText" required>
                </div>
                <div class="form-group">
                    <label for="editTaskPriority">Priority</label>
                    <select id="editTaskPriority">
                        <option value="none">None</option>
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editTaskProject">Linked Project</label>
                    <select id="editTaskProject">
                        <option value="">No Project</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editTaskDueDate">Due Date</label>
                    <input type="date" id="editTaskDueDate">
                </div>
                <div class="form-group">
                    <label for="editTaskTime">Time (Optional)</label>
                    <input type="time" id="editTaskTime">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">Save Changes</button>
                    <button type="button" class="btn btn-secondary" id="cancelTaskEdit">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Project Edit Modal -->
    <div class="edit-modal" id="projectEditModal">
        <div class="todo-container modal-content">
            <div class="todo-header">
                <h2 id="editProjectModalTitle">Edit Project</h2>
                <button class="close-modal" id="closeProjectModal"></button>
            </div>
            <form id="projectEditForm">
                <div class="form-group">
                    <label for="editProjectTitle">Project Title</label>
                    <input type="text" id="editProjectTitle" required>
                </div>
                <div class="form-group">
                    <label for="editProjectDescription">Description</label>
                    <textarea id="editProjectDescription"></textarea>
                </div>
                <div class="form-group">
                    <label for="editProjectStatus">Status</label>
                    <select id="editProjectStatus">
                        <option value="active">Active</option>
                        <option value="completed">Completed</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">Save Changes</button>
                    <button type="button" class="btn btn-secondary" id="cancelProjectEdit">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Habit Edit Modal -->
    <div class="edit-modal" id="habitEditModal">
        <div class="todo-container modal-content">
            <div class="todo-header">
                <h2 id="editHabitModalTitle">Edit Habit</h2>
                <button class="close-modal" id="closeHabitModal"></button>
            </div>
            <form id="habitEditForm">
                <div class="form-group">
                    <label for="editHabitName">Habit Name</label>
                    <input type="text" id="editHabitName" required>
                </div>
                <div class="form-group">
                    <label>Days of the Week</label>
                    <div class="habit-days-selector">
                        <button type="button" class="habit-day-btn" data-day="0">Sun</button>
                        <button type="button" class="habit-day-btn" data-day="1">Mon</button>
                        <button type="button" class="habit-day-btn" data-day="2">Tue</button>
                        <button type="button" class="habit-day-btn" data-day="3">Wed</button>
                        <button type="button" class="habit-day-btn" data-day="4">Thu</button>
                        <button type="button" class="habit-day-btn" data-day="5">Fri</button>
                        <button type="button" class="habit-day-btn" data-day="6">Sat</button>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn">Save Changes</button>
                    <button type="button" class="btn btn-secondary" id="cancelHabitEdit">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Mobile Header -->
    <div class="mobile-header">
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        <div class="mobile-logo">
            <i class="fas fa-tasks"></i>
            <h2 data-i18n="appName">AAW Productivity Pro</h2>
        </div>
        <div class="mobile-actions">
            <button class="mobile-settings-btn" id="mobileSettingsBtn">
                <i class="fas fa-cog"></i>
            </button>
            <div class="mobile-date" id="mobileDate">Today</div>
        </div>
    </div>

    <!-- Main App -->
    <div class="container" id="appContainer">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <i class="fas fa-tasks"></i>
                <h2 data-i18n="appName">AAW Productivity Pro</h2>
            </div>
            
            <div class="nav-menu">
                <a href="#" class="nav-item active" data-tab="dashboard">
                    <i class="fas fa-home"></i>
                    <span data-i18n="dashboard">Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-tab="calendar">
                    <i class="fas fa-calendar-alt"></i>
                    <span data-i18n="calendar">Calendar</span>
                </a>
                <a href="#" class="nav-item" data-tab="todo">
                    <i class="fas fa-list-check"></i>
                    <span data-i18n="todoList">To-Do List</span>
                </a>
                <a href="#" class="nav-item" data-tab="projects">
                    <i class="fas fa-project-diagram"></i>
                    <span data-i18n="projects">Projects</span>
                </a>
                <a href="#" class="nav-item" data-tab="planner">
                    <i class="fas fa-calendar-day"></i>
                    <span data-i18n="dailyPlanner">Daily Planner</span>
                </a>
                <a href="#" class="nav-item" data-tab="procrastination">
                    <i class="fas fa-fist-raised"></i>
                    <span data-i18n="focus">Focus</span>
                </a>
                
                <div class="settings-nav-item" id="settingsNavBtn">
                    <i class="fas fa-cog"></i>
                    <span data-i18n="settings">Settings</span>
                </div>
                
                <div class="clear-btn" id="clearDataBtn">
                    <i class="fas fa-trash-alt"></i>
                    <span data-i18n="clearData">Clear All Data</span>
                </div>
            </div>
            
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">YP</div>
                <div class="user-details">
                    <h4 id="displayUsername" data-i18n="yourProfile">Your Profile</h4>
                    <p data-i18n="localUser">Local User</p>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <h1 id="pageTitle" data-i18n="dashboard">Dashboard</h1>
                    <div class="date-display" id="currentDate">Monday, October 16, 2023</div>
                </div>
                <div class="header-actions">
                    <button class="header-btn" id="themeToggleBtn" title="Toggle Theme">
                        <i class="fas fa-sun"></i>
                    </button>
                    <button class="header-btn" id="languageToggleBtn" title="Toggle Language">
                        <i class="fas fa-language"></i>
                    </button>
                    <button class="header-btn" id="viewToggleBtn" title="Toggle View">
                        <i class="fas fa-desktop"></i>
                    </button>
                    <button class="header-btn settings-btn" id="settingsBtn">
                        <i class="fas fa-cog"></i>
                        <span data-i18n="settings">Settings</span>
                    </button>
                </div>
            </div>

            <!-- Welcome Message -->
            <div class="welcome-message">
                <h2 data-i18n="welcomeTitle">Welcome to AAW Productivity Pro!</h2>
                <p data-i18n="welcomeMessage">Your all-in-one productivity tool with calendar, task manager, project organizer, and procrastination fighter.</p>
            </div>
            
            <!-- Dashboard Tab -->
            <div class="tab-content active" id="dashboard">
                <div class="dashboard-cards">
                    <div class="card">
                        <h3 data-i18n="tasksToday">Tasks Today</h3>
                        <div class="card-content">
                            <div class="card-number" id="todayTasksCount">0</div>
                            <div class="card-icon">
                                <i class="fas fa-tasks"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 data-i18n="completedTasks">Completed Tasks</h3>
                        <div class="card-content">
                            <div class="card-number" id="completedTasksCount">0</div>
                            <div class="card-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 data-i18n="activeProjects">Active Projects</h3>
                        <div class="card-content">
                            <div class="card-number" id="activeProjectsCount">0</div>
                            <div class="card-icon">
                                <i class="fas fa-project-diagram"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h3 data-i18n="productivityScore">Productivity Score</h3>
                        <div class="card-content">
                            <div class="card-number" id="productivityScore">0%</div>
                            <div class="card-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="todo-container">
                    <div class="todo-header">
                        <h2 data-i18n="priorityTasks">Today's Priority Tasks</h2>
                        <span class="date-display" data-i18n="dueToday">Due today</span>
                    </div>
                    
                    <ul class="todo-list" id="dashboardTodoList">
                        <!-- Tasks will be added here dynamically -->
                    </ul>
                </div>
            </div>
            
            <!-- Calendar Tab -->
            <div class="tab-content" id="calendar">
                <div class="calendar-header">
                    <h2 id="calendarMonth">October 2023</h2>
                    <div class="calendar-nav">
                        <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                        <button id="todayBtn" data-i18n="today">Today</button>
                        <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                
                <!-- Week View for Mobile -->
                <div class="calendar-week-view" id="calendarWeekView"></div>
                
                <!-- Month Grid for Desktop -->
                <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be generated here -->
                </div>
                
                <div class="todo-container" style="margin-top: 20px;">
                    <h2 data-i18n="calendarEvents">Calendar Events</h2>
                    <div class="calendar-event-form">
                        <input type="text" id="newEventInput" data-i18n-placeholder="eventPlaceholder" placeholder="Add new event...">
                        <input type="date" id="eventDateInput">
                        <input type="time" id="eventTimeInput" class="event-time-input" value="09:00">
                        <select id="eventReminderSelect" class="event-reminder-select">
                            <option value="">No Reminder</option>
                            <option value="5">5 min before</option>
                            <option value="15">15 min before</option>
                            <option value="30">30 min before</option>
                            <option value="60">1 hour before</option>
                            <option value="1440">1 day before</option>
                        </select>
                        <button id="addEventBtn" class="btn"><i class="fas fa-plus"></i></button>
                    </div>
                    
                    <ul class="todo-list" id="calendarEventsList">
                        <!-- Calendar events will be added here dynamically -->
                    </ul>
                </div>
            </div>
            
            <!-- To-Do List Tab -->
            <div class="tab-content" id="todo">
                <div class="todo-container">
                    <div class="todo-header">
                        <h2 data-i18n="myTodoList">My To-Do List</h2>
                        <span class="date-display" id="todoDate" data-i18n="today">Today</span>
                    </div>
                    
                    <div class="todo-input">
                        <input type="text" id="newTaskInput" data-i18n-placeholder="addTaskPlaceholder" placeholder="Add a new task...">
                        <select id="taskPrioritySelect">
                            <option value="none">Priority</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                        <select id="taskProjectSelect">
                            <option value="">No Project</option>
                        </select>
                        <button id="addTaskBtn"><i class="fas fa-plus"></i></button>
                    </div>
                    
                    <div class="todo-filters">
                        <button class="filter-btn active" data-filter="all" data-i18n="all">All</button>
                        <button class="filter-btn" data-filter="active" data-i18n="active">Active</button>
                        <button class="filter-btn" data-filter="completed" data-i18n="completed">Completed</button>
                        <button class="filter-btn" data-filter="priority" data-i18n="priority">Priority</button>
                        <button class="filter-btn" data-filter="high" data-i18n="highPriority">High Priority</button>
                    </div>
                    
                    <ul class="todo-list" id="todoList">
                        <!-- Tasks will be added here dynamically -->
                    </ul>
                </div>
            </div>
            
            <!-- Project Manager Tab -->
            <div class="tab-content" id="projects">
                <div class="projects-grid" id="projectsGrid">
                    <!-- Projects will be added here dynamically -->
                </div>
                
                <div class="todo-container" style="margin-top: 20px;">
                    <h2 data-i18n="addNewProject">Add New Project</h2>
                    <div class="todo-input">
                        <input type="text" id="newProjectInput" data-i18n-placeholder="projectNamePlaceholder" placeholder="Project name...">
                        <button id="addProjectBtn"><i class="fas fa-plus"></i></button>
                    </div>
                </div>
            </div>
            
            <!-- Daily Planner Tab -->
            <div class="tab-content" id="planner">
                <div class="planner-container">
                    <div class="planner-sidebar">
                        <div class="planner-day-selector">
                            <h3 data-i18n="selectDate">Select Date</h3>
                            <input type="date" id="plannerDate" value="">
                        </div>
                        
                        <div class="planner-daily-goals">
                            <h3 data-i18n="dailyGoals">Daily Goals</h3>
                            <textarea id="dailyGoals" placeholder="What do you want to achieve today?"></textarea>
                            <button class="btn" id="saveGoalsBtn" style="margin-top: 10px; width: 100%;">
                                <i class="fas fa-save"></i> <span data-i18n="saveGoals">Save Goals</span>
                            </button>
                        </div>
                        
                        <div class="planner-tasks">
                            <h3 data-i18n="todaysTasks">Today's Tasks</h3>
                            <div class="planner-tasks-list" id="plannerTasksList">
                                <!-- Tasks for selected date will appear here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="planner-main">
                        <div class="time-block-container">
                            <div class="todo-header">
                                <h2 data-i18n="timeBlocks">Time Blocks</h2>
                                <button class="btn" id="addTimeBlockBtn">
                                    <i class="fas fa-plus"></i> <span data-i18n="addBlock">Add Block</span>
                                </button>
                            </div>
                            
                            <div class="time-blocks" id="timeBlocks">
                                <!-- Time blocks will be added here -->
                            </div>
                        </div>
                        
                        <div class="todo-container">
                            <h2 data-i18n="notes">Notes</h2>
                            <textarea id="plannerNotes" placeholder="Add notes for today..." style="width: 100%; min-height: 150px; margin-bottom: 15px;"></textarea>
                            <button class="btn" id="saveNotesBtn">
                                <i class="fas fa-save"></i> <span data-i18n="saveNotes">Save Notes</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Focus/Procrastination Fighter Tab -->
            <div class="tab-content" id="procrastination">
                <div class="productivity-tools-grid">
                    <div class="timer-card">
                        <h2 data-i18n="pomodoroTimer">Pomodoro Timer</h2>
                        <p data-i18n="timerDescription">Focus for 25 minutes, then take a 5-minute break</p>
                        
                        <div class="timer-display" id="timerDisplay">25:00</div>
                        
                        <div class="timer-controls">
                            <button class="btn-start" id="startTimer" data-i18n="start">Start</button>
                            <button class="btn-pause" id="pauseTimer" data-i18n="pause">Pause</button>
                            <button class="btn-reset" id="resetTimer" data-i18n="reset">Reset</button>
                        </div>
                        
                        <div class="timer-presets">
                            <button class="timer-preset" data-minutes="25">25 min</button>
                            <button class="timer-preset" data-minutes="15">15 min</button>
                            <button class="timer-preset" data-minutes="5">5 min</button>
                        </div>
                        
                        <p data-i18n="sessionsCompleted">Sessions completed today: <strong id="sessionCount">0</strong></p>
                    </div>
                    
                    <div class="habit-tracker">
                        <h3 data-i18n="habitTracker">Habit Tracker</h3>
                        <p data-i18n="habitDescription">Track your daily habits</p>
                        
                        <div id="habitsList">
                            <!-- Habits will be added here dynamically -->
                        </div>
                        
                        <div class="todo-input" style="margin-top: 15px;">
                            <input type="text" id="newHabitInput" placeholder="Add new habit...">
                            <button id="addHabitBtn"><i class="fas fa-plus"></i></button>
                        </div>
                        
                        <div class="habit-tracker-grid" id="habitTracker">
                            <!-- Habit tracker grid will be generated here -->
                        </div>
                    </div>
                </div>
                
                <div class="productivity-tools-grid">
                    <div class="quick-notes">
                        <h3 data-i18n="quickNotes">Quick Notes</h3>
                        <textarea id="quickNotes" placeholder="Jot down quick thoughts or ideas..."></textarea>
                        <button class="btn" id="saveQuickNotesBtn">
                            <i class="fas fa-save"></i> <span data-i18n="save">Save</span>
                        </button>
                    </div>
                    
                    <div class="priority-matrix">
                        <h3 data-i18n="priorityMatrix">Eisenhower Matrix</h3>
                        <p data-i18n="matrixDescription">Organize tasks by urgency and importance</p>
                        <div class="matrix-grid">
                            <div class="matrix-quadrant quadrant-1">
                                <h5 data-i18n="urgentImportant">Urgent & Important <span id="quadrant1-count">0</span></h5>
                                <div class="matrix-items" id="quadrant1" data-quadrant="1">
                                    <!-- Quadrant 1 items -->
                                </div>
                                <div class="matrix-add-form">
                                    <input type="text" class="matrix-input" data-quadrant="1" placeholder="Add item...">
                                    <button class="matrix-add-btn" data-quadrant="1">Add</button>
                                </div>
                            </div>
                            <div class="matrix-quadrant quadrant-2">
                                <h5 data-i18n="notUrgentImportant">Not Urgent & Important <span id="quadrant2-count">0</span></h5>
                                <div class="matrix-items" id="quadrant2" data-quadrant="2">
                                    <!-- Quadrant 2 items -->
                                </div>
                                <div class="matrix-add-form">
                                    <input type="text" class="matrix-input" data-quadrant="2" placeholder="Add item...">
                                    <button class="matrix-add-btn" data-quadrant="2">Add</button>
                                </div>
                            </div>
                            <div class="matrix-quadrant quadrant-3">
                                <h5 data-i18n="urgentNotImportant">Urgent & Not Important <span id="quadrant3-count">0</span></h5>
                                <div class="matrix-items" id="quadrant3" data-quadrant="3">
                                    <!-- Quadrant 3 items -->
                                </div>
                                <div class="matrix-add-form">
                                    <input type="text" class="matrix-input" data-quadrant="3" placeholder="Add item...">
                                    <button class="matrix-add-btn" data-quadrant="3">Add</button>
                                </div>
                            </div>
                            <div class="matrix-quadrant quadrant-4">
                                <h5 data-i18n="notUrgentNotImportant">Not Urgent & Not Important <span id="quadrant4-count">0</span></h5>
                                <div class="matrix-items" id="quadrant4" data-quadrant="4">
                                    <!-- Quadrant 4 items -->
                                </div>
                                <div class="matrix-add-form">
                                    <input type="text" class="matrix-input" data-quadrant="4" placeholder="Add item...">
                                    <button class="matrix-add-btn" data-quadrant="4">Add</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="motivation-card">
                    <h3 data-i18n="motivationBoost">Motivation Boost</h3>
                    <div class="motivation-quote" id="motivationQuote">
                        "The way to get started is to quit talking and begin doing."
                    </div>
                    <div class="motivation-author" id="motivationAuthor">- Walt Disney</div>
                    
                    <button class="btn" id="newQuoteBtn" style="margin-top: 20px; width: auto;">
                        <i class="fas fa-sync-alt"></i> <span data-i18n="newMotivation">New Motivation</span>
                    </button>
                </div>
                
                <div class="todo-container" style="margin-top: 20px;">
                    <h2 data-i18n="procrastinationTips">Procrastination Tips</h2>
                    <ul class="todo-list">
                        <li class="todo-item">
                            <div class="todo-text" data-i18n="tip1">Break large tasks into smaller, manageable steps</div>
                        </li>
                        <li class="todo-item">
                            <div class="todo-text" data-i18n="tip2">Use the Pomodoro technique (25 mins work, 5 mins break)</div>
                        </li>
                        <li class="todo-item">
                            <div class="todo-text" data-i18n="tip3">Eliminate distractions by turning off notifications</div>
                        </li>
                        <li class="todo-item">
                            <div class="todo-text" data-i18n="tip4">Start with the most difficult task first (eat the frog)</div>
                        </li>
                        <li class="todo-item">
                            <div class="todo-text" data-i18n="tip5">Reward yourself after completing tasks</div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Navigation Bar -->
    <div class="mobile-nav">
        <a href="#" class="mobile-nav-item active" data-tab="dashboard">
            <i class="fas fa-home"></i>
            <span data-i18n="home">Home</span>
        </a>
        <a href="#" class="mobile-nav-item" data-tab="calendar">
            <i class="fas fa-calendar-alt"></i>
            <span data-i18n="calendar">Calendar</span>
        </a>
        <a href="#" class="mobile-nav-item" data-tab="todo">
            <i class="fas fa-list-check"></i>
            <span data-i18n="tasks">Tasks</span>
        </a>
        <a href="#" class="mobile-nav-item" data-tab="projects">
            <i class="fas fa-project-diagram"></i>
            <span data-i18n="projects">Projects</span>
        </a>
        <a href="#" class="mobile-nav-item" data-tab="planner">
            <i class="fas fa-calendar-day"></i>
            <span data-i18n="planner">Planner</span>
        </a>
        <a href="#" class="mobile-nav-item" data-tab="procrastination">
            <i class="fas fa-fist-raised"></i>
            <span data-i18n="focus">Focus</span>
        </a>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toastNotification">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Operation completed successfully!</span>
    </div>

    <script>
        // ============================================
        // AAW PRODUCTIVITY PRO APPLICATION
        // ============================================

        // DOM Elements
        const elements = {
            settingsPanel: document.getElementById('settingsPanel'),
            closeSettingsBtn: document.getElementById('closeSettings'),
            settingsBtn: document.getElementById('settingsBtn'),
            mobileSettingsBtn: document.getElementById('mobileSettingsBtn'),
            settingsNavBtn: document.getElementById('settingsNavBtn'),
            themeToggleBtn: document.getElementById('themeToggleBtn'),
            languageToggleBtn: document.getElementById('languageToggleBtn'),
            viewToggleBtn: document.getElementById('viewToggleBtn'),
            themeButtons: document.querySelectorAll('.theme-btn'),
            languageButtons: document.querySelectorAll('.lang-btn'),
            viewButtons: document.querySelectorAll('.view-btn'),
            pageTitle: document.getElementById('pageTitle'),
            currentDate: document.getElementById('currentDate'),
            mobileDate: document.getElementById('mobileDate'),
            navItems: document.querySelectorAll('.nav-item'),
            mobileNavItems: document.querySelectorAll('.mobile-nav-item'),
            tabContents: document.querySelectorAll('.tab-content'),
            clearDataBtn: document.getElementById('clearDataBtn'),
            mobileMenuBtn: document.getElementById('mobileMenuBtn'),
            sidebar: document.getElementById('sidebar'),
            todayTasksCount: document.getElementById('todayTasksCount'),
            completedTasksCount: document.getElementById('completedTasksCount'),
            activeProjectsCount: document.getElementById('activeProjectsCount'),
            productivityScore: document.getElementById('productivityScore'),
            calendarGrid: document.getElementById('calendarGrid'),
            calendarWeekView: document.getElementById('calendarWeekView'),
            calendarMonth: document.getElementById('calendarMonth'),
            prevMonthBtn: document.getElementById('prevMonth'),
            nextMonthBtn: document.getElementById('nextMonth'),
            todayBtn: document.getElementById('todayBtn'),
            newEventInput: document.getElementById('newEventInput'),
            eventDateInput: document.getElementById('eventDateInput'),
            eventTimeInput: document.getElementById('eventTimeInput'),
            eventReminderSelect: document.getElementById('eventReminderSelect'),
            addEventBtn: document.getElementById('addEventBtn'),
            calendarEventsList: document.getElementById('calendarEventsList'),
            newTaskInput: document.getElementById('newTaskInput'),
            taskPrioritySelect: document.getElementById('taskPrioritySelect'),
            taskProjectSelect: document.getElementById('taskProjectSelect'),
            addTaskBtn: document.getElementById('addTaskBtn'),
            todoList: document.getElementById('todoList'),
            dashboardTodoList: document.getElementById('dashboardTodoList'),
            filterButtons: document.querySelectorAll('.filter-btn'),
            taskEditModal: document.getElementById('taskEditModal'),
            closeTaskModal: document.getElementById('closeTaskModal'),
            cancelTaskEdit: document.getElementById('cancelTaskEdit'),
            taskEditForm: document.getElementById('taskEditForm'),
            editTaskText: document.getElementById('editTaskText'),
            editTaskPriority: document.getElementById('editTaskPriority'),
            editTaskProject: document.getElementById('editTaskProject'),
            editTaskDueDate: document.getElementById('editTaskDueDate'),
            editTaskTime: document.getElementById('editTaskTime'),
            projectEditModal: document.getElementById('projectEditModal'),
            closeProjectModal: document.getElementById('closeProjectModal'),
            cancelProjectEdit: document.getElementById('cancelProjectEdit'),
            projectEditForm: document.getElementById('projectEditForm'),
            editProjectTitle: document.getElementById('editProjectTitle'),
            editProjectDescription: document.getElementById('editProjectDescription'),
            editProjectStatus: document.getElementById('editProjectStatus'),
            projectsGrid: document.getElementById('projectsGrid'),
            newProjectInput: document.getElementById('newProjectInput'),
            addProjectBtn: document.getElementById('addProjectBtn'),
            timerDisplay: document.getElementById('timerDisplay'),
            startTimerBtn: document.getElementById('startTimer'),
            pauseTimerBtn: document.getElementById('pauseTimer'),
            resetTimerBtn: document.getElementById('resetTimer'),
            sessionCount: document.getElementById('sessionCount'),
            motivationQuote: document.getElementById('motivationQuote'),
            motivationAuthor: document.getElementById('motivationAuthor'),
            newQuoteBtn: document.getElementById('newQuoteBtn'),
            timerPresets: document.querySelectorAll('.timer-preset'),
            exportDataBtn: document.getElementById('exportDataBtn'),
            importDataBtn: document.getElementById('importDataBtn'),
            importFileInput: document.getElementById('importFileInput'),
            toastNotification: document.getElementById('toastNotification'),
            toastMessage: document.getElementById('toastMessage'),
            // NEW: Planner elements
            plannerDate: document.getElementById('plannerDate'),
            dailyGoals: document.getElementById('dailyGoals'),
            saveGoalsBtn: document.getElementById('saveGoalsBtn'),
            plannerTasksList: document.getElementById('plannerTasksList'),
            timeBlocks: document.getElementById('timeBlocks'),
            addTimeBlockBtn: document.getElementById('addTimeBlockBtn'),
            plannerNotes: document.getElementById('plannerNotes'),
            saveNotesBtn: document.getElementById('saveNotesBtn'),
            // NEW: Focus tools elements
            habitsList: document.getElementById('habitsList'),
            habitTracker: document.getElementById('habitTracker'),
            newHabitInput: document.getElementById('newHabitInput'),
            addHabitBtn: document.getElementById('addHabitBtn'),
            quickNotes: document.getElementById('quickNotes'),
            saveQuickNotesBtn: document.getElementById('saveQuickNotesBtn'),
            // Matrix elements
            quadrant1: document.getElementById('quadrant1'),
            quadrant2: document.getElementById('quadrant2'),
            quadrant3: document.getElementById('quadrant3'),
            quadrant4: document.getElementById('quadrant4'),
            quadrant1Count: document.getElementById('quadrant1-count'),
            quadrant2Count: document.getElementById('quadrant2-count'),
            quadrant3Count: document.getElementById('quadrant3-count'),
            quadrant4Count: document.getElementById('quadrant4-count'),
            // Habit Edit Modal
            habitEditModal: document.getElementById('habitEditModal'),
            closeHabitModal: document.getElementById('closeHabitModal'),
            cancelHabitEdit: document.getElementById('cancelHabitEdit'),
            habitEditForm: document.getElementById('habitEditForm'),
            editHabitName: document.getElementById('editHabitName')
        };

        // App State
        const state = {
            currentTab: 'dashboard',
            currentCalendarDate: new Date(),
            timerInterval: null,
            timerSeconds: 25 * 60,
            timerRunning: false,
            sessionsCompleted: 0,
            currentFilter: 'all',
            editingTaskId: null,
            editingProjectId: null,
            editingHabitId: null,
            taskCounter: 1,
            // NEW: Planner state
            selectedPlannerDate: new Date().toISOString().split('T')[0],
            draggingMatrixItem: null
        };

        // App Data
        const data = {
            tasks: [],
            projects: [],
            calendarEvents: [],
            // NEW: Planner data
            plannerData: {},
            // NEW: Focus tools data
            habits: [],
            quickNotesText: '',
            matrixItems: {
                '1': [], // Urgent & Important
                '2': [], // Not Urgent & Important
                '3': [], // Urgent & Not Important
                '4': []  // Not Urgent & Not Important
            }
        };

        // App Settings
        const settings = {
            theme: 'auto',
            language: 'en',
            viewMode: 'auto',
            notifications: true
        };

        // ============================================
        // COMPLETE TRANSLATIONS
        // ============================================

        const translations = {
            en: {
                // App
                appName: "AAW Productivity Pro",
                settings: "Settings",
                dashboard: "Dashboard",
                calendar: "Calendar",
                todoList: "To-Do List",
                projects: "Projects",
                dailyPlanner: "Daily Planner",
                focus: "Focus",
                clearData: "Clear All Data",
                
                // User
                yourProfile: "Your Profile",
                localUser: "Local User",
                
                // Welcome
                welcomeTitle: "Welcome to AAW Productivity Pro!",
                welcomeMessage: "Your all-in-one productivity tool with calendar, task manager, project organizer, and procrastination fighter.",
                
                // Dashboard
                tasksToday: "Tasks Today",
                completedTasks: "Completed Tasks",
                activeProjects: "Active Projects",
                productivityScore: "Productivity Score",
                priorityTasks: "Today's Priority Tasks",
                dueToday: "Due today",
                
                // Calendar
                today: "Today",
                calendarEvents: "Calendar Events",
                eventPlaceholder: "Add new event...",
                months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
                days: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                
                // Todo
                myTodoList: "My To-Do List",
                addTaskPlaceholder: "Add a new task...",
                all: "All",
                active: "Active",
                completed: "Completed",
                priority: "Priority",
                highPriority: "High Priority",
                lowPriority: "Low Priority",
                mediumPriority: "Medium Priority",
                
                // Projects
                addNewProject: "Add New Project",
                projectNamePlaceholder: "Project name...",
                noFiles: "No files attached",
                projectTasks: "Project Tasks",
                uploadFiles: "Click to upload files",
                
                // Planner
                selectDate: "Select Date",
                dailyGoals: "Daily Goals",
                saveGoals: "Save Goals",
                todaysTasks: "Today's Tasks",
                timeBlocks: "Time Blocks",
                addBlock: "Add Block",
                notes: "Notes",
                saveNotes: "Save Notes",
                planner: "Planner",
                
                // Timer
                pomodoroTimer: "Pomodoro Timer",
                timerDescription: "Focus for 25 minutes, then take a 5-minute break",
                start: "Start",
                pause: "Pause",
                reset: "Reset",
                sessionsCompleted: "Sessions completed today:",
                
                // Focus Tools
                habitTracker: "Habit Tracker",
                habitDescription: "Track your daily habits",
                quickNotes: "Quick Notes",
                priorityMatrix: "Eisenhower Matrix",
                matrixDescription: "Organize tasks by urgency and importance",
                urgentImportant: "Urgent & Important",
                notUrgentImportant: "Not Urgent & Important",
                urgentNotImportant: "Urgent & Not Important",
                notUrgentNotImportant: "Not Urgent & Not Important",
                
                // Motivation
                motivationBoost: "Motivation Boost",
                newMotivation: "New Motivation",
                
                // Tips
                procrastinationTips: "Procrastination Tips",
                tip1: "Break large tasks into smaller, manageable steps",
                tip2: "Use the Pomodoro technique (25 mins work, 5 mins break)",
                tip3: "Eliminate distractions by turning off notifications",
                tip4: "Start with the most difficult task first (eat the frog)",
                tip5: "Reward yourself after completing tasks",
                
                // Settings
                theme: "Theme",
                light: "Light",
                dark: "Dark",
                auto: "Auto",
                language: "Language",
                viewMode: "View Mode",
                mobile: "Mobile",
                desktop: "Desktop",
                notifications: "Notifications",
                dataManagement: "Data Management",
                exportData: "Export Data",
                importData: "Import Data",
                
                // Mobile
                home: "Home",
                tasks: "Tasks",
                
                // Alerts
                confirmClear: "Are you sure you want to clear all data? This will reset tasks, projects, and timer sessions.",
                dataCleared: "All data has been cleared. The app has been reset to initial state.",
                exportSuccess: "Data exported successfully!",
                importSuccess: "Data imported successfully!",
                importError: "Error importing data. Please check the file format.",
                fileAdded: "file(s) added to project",
                confirmDeleteProject: "Are you sure you want to delete this project? All tasks linked to it will be unlinked.",
                projectDeleted: "Project deleted successfully!",
                confirmDeleteHabit: "Are you sure you want to delete this habit?",
                habitDeleted: "Habit deleted successfully!",
                confirmDeleteMatrixItem: "Are you sure you want to delete this item?",
                matrixItemDeleted: "Item deleted successfully!",
                
                // Validation
                enterTask: "Please enter a task",
                enterProjectName: "Please enter a project name",
                enterEvent: "Please enter an event",
                selectDate: "Please select a date",
                timerComplete: "Time's up! Take a 5-minute break.",
                enterHabit: "Please enter a habit name",
                enterMatrixItem: "Please enter an item",
                habitAdded: "Habit added successfully!",
                habitUpdated: "Habit updated successfully!",
                goalsSaved: "Daily goals saved!",
                notesSaved: "Notes saved!",
                timeBlockAdded: "Time block added!",
                timeBlockRemoved: "Time block removed!",
                matrixItemAdded: "Item added to matrix!",
                
                // Notifications
                taskAdded: "Task added successfully!",
                projectAdded: "Project added successfully!",
                taskUpdated: "Task updated successfully!",
                projectUpdated: "Project updated successfully!",
                eventAdded: "Event added successfully!",
                reminderSet: "Reminder set for "
            },
            
            ar: {
                // App
                appName: "AAW  ",
                settings: "",
                dashboard: " ",
                calendar: "",
                todoList: " ",
                projects: "",
                dailyPlanner: " ",
                focus: "",
                clearData: "  ",
                
                // User
                yourProfile: " ",
                localUser: " ",
                
                // Welcome
                welcomeTitle: "   AAW  !",
                welcomeMessage: "          .",
                
                // Dashboard
                tasksToday: " ",
                completedTasks: " ",
                activeProjects: " ",
                productivityScore: " ",
                priorityTasks: "  ",
                dueToday: " ",
                
                // Calendar
                today: "",
                calendarEvents: " ",
                eventPlaceholder: "  ...",
                months: ["", "", "", "", "", "", "", "", "", "", "", ""],
                days: ["", "", "", "", "", "", ""],
                
                // Todo
                myTodoList: " ",
                addTaskPlaceholder: "  ...",
                all: "",
                active: "",
                completed: "",
                priority: "",
                highPriority: " ",
                lowPriority: " ",
                mediumPriority: " ",
                
                // Projects
                addNewProject: "  ",
                projectNamePlaceholder: " ...",
                noFiles: "   ",
                projectTasks: " ",
                uploadFiles: "  ",
                
                // Planner
                selectDate: " ",
                dailyGoals: " ",
                saveGoals: " ",
                todaysTasks: " ",
                timeBlocks: " ",
                addBlock: " ",
                notes: "",
                saveNotes: " ",
                planner: "",
                
                // Timer
                pomodoroTimer: " ",
                timerDescription: "  25      5 ",
                start: "",
                pause: " ",
                reset: " ",
                sessionsCompleted: "  :",
                
                // Focus Tools
                habitTracker: " ",
                habitDescription: "  ",
                quickNotes: " ",
                priorityMatrix: " ",
                matrixDescription: "    ",
                urgentImportant: " ",
                notUrgentImportant: "  ",
                urgentNotImportant: "  ",
                notUrgentNotImportant: "   ",
                
                // Motivation
                motivationBoost: " ",
                newMotivation: " ",
                
                // Tips
                procrastinationTips: "  ",
                tip1: "       ",
                tip2: "   (25   5  )",
                tip3: "    ",
                tip4: "    ( )",
                tip5: "    ",
                
                // Settings
                theme: "",
                light: "",
                dark: "",
                auto: "",
                language: "",
                viewMode: " ",
                mobile: "",
                desktop: " ",
                notifications: "",
                dataManagement: " ",
                exportData: " ",
                importData: " ",
                
                // Mobile
                home: "",
                tasks: "",
                
                // Alerts
                confirmClear: "              .",
                dataCleared: "   .       .",
                exportSuccess: "   !",
                importSuccess: "   !",
                importError: "   .     .",
                fileAdded: "/    ",
                confirmDeleteProject: "              .",
                projectDeleted: "   !",
                confirmDeleteHabit: "       ",
                habitDeleted: "   !",
                confirmDeleteMatrixItem: "       ",
                matrixItemDeleted: "   !",
                
                // Validation
                enterTask: "  ",
                enterProjectName: "   ",
                enterEvent: "  ",
                selectDate: "  ",
                timerComplete: " !    5 .",
                enterHabit: "   ",
                enterMatrixItem: "  ",
                habitAdded: "   !",
                habitUpdated: "   !",
                goalsSaved: "   !",
                notesSaved: "  !",
                timeBlockAdded: "   !",
                timeBlockRemoved: "   !",
                matrixItemAdded: "    !",
                
                // Notifications
                taskAdded: "   !",
                projectAdded: "   !",
                taskUpdated: "   !",
                projectUpdated: "   !",
                eventAdded: "   !",
                reminderSet: "    "
            }
        };

        // Sample data
        const sampleData = {
            tasks: [
                { id: 1, text: 'Complete project proposal', completed: false, priority: 'high', projectId: 1, dueDate: getFutureDate(3), taskNumber: 1 },
                { id: 2, text: 'Schedule team meeting', completed: true, priority: 'medium', projectId: 2, dueDate: getFutureDate(1), taskNumber: 2 },
                { id: 3, text: 'Review quarterly reports', completed: false, priority: 'high', projectId: 1, dueDate: getFutureDate(7), taskNumber: 3 },
                { id: 4, text: 'Prepare presentation slides', completed: false, priority: 'medium', projectId: null, dueDate: getFutureDate(4), taskNumber: 4 },
                { id: 5, text: 'Update project documentation', completed: false, priority: 'low', projectId: 3, dueDate: getFutureDate(10), taskNumber: 5 }
            ],
            projects: [
                {
                    id: 1,
                    title: 'Website Redesign',
                    description: 'Complete redesign of company website with modern UI/UX',
                    status: 'active',
                    files: ['design-mockup.pdf', 'content-plan.docx']
                },
                {
                    id: 2,
                    title: 'Marketing Campaign',
                    description: 'Q4 social media marketing campaign planning and execution',
                    status: 'active',
                    files: ['campaign-budget.xlsx']
                },
                {
                    id: 3,
                    title: 'Product Launch',
                    description: 'Launch of new productivity software',
                    status: 'completed',
                    files: ['launch-plan.pdf', 'press-release.docx']
                }
            ],
            calendarEvents: [
                { id: 1, title: 'Team Meeting', date: getFutureDate(3), time: '10:00', reminder: 30, type: 'meeting' },
                { id: 2, title: 'Project Deadline', date: getFutureDate(7), time: '17:00', reminder: 1440, type: 'deadline' },
                { id: 3, title: 'Client Presentation', date: getFutureDate(4), time: '14:30', reminder: 60, type: 'presentation' }
            ],
            habits: [
                { id: 1, name: 'Morning Exercise', checkedDays: [1, 3, 5] },
                { id: 2, name: 'Read 30 min', checkedDays: [0, 1, 2, 3, 4, 5, 6] },
                { id: 3, name: 'Meditate', checkedDays: [0, 2, 4, 6] }
            ],
            matrixItems: {
                '1': [{id: 1, text: 'Finish project proposal'}, {id: 2, text: 'Prepare for client meeting'}],
                '2': [{id: 3, text: 'Learn new programming language'}, {id: 4, text: 'Plan vacation'}],
                '3': [{id: 5, text: 'Answer emails'}, {id: 6, text: 'Team status update'}],
                '4': [{id: 7, text: 'Browse social media'}, {id: 8, text: 'Watch TV'}]
            }
        };

        const motivationQuotes = {
            en: [
                { quote: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
                { quote: "Your time is limited, so don't waste it living someone else's life.", author: "Steve Jobs" },
                { quote: "The future depends on what you do today.", author: "Mahatma Gandhi" }
            ],
            ar: [
                { quote: "        .", author: " " },
                { quote: "         .", author: " " },
                { quote: "     .", author: " " }
            ]
        };

        // Helper functions
        function getFutureDate(days) {
            const date = new Date();
            date.setDate(date.getDate() + days);
            return date.toISOString().split('T')[0];
        }

        function showToast(message, type = 'success') {
            const toast = elements.toastNotification;
            const messageEl = elements.toastMessage;
            
            messageEl.textContent = message;
            toast.className = `toast toast-${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        function formatTime(time) {
            if (!time) return '';
            const [hours, minutes] = time.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const displayHour = hour % 12 || 12;
            return `${displayHour}:${minutes} ${ampm}`;
        }

        function getReminderText(minutes) {
            if (!minutes) return '';
            if (minutes < 60) return `${minutes} min`;
            if (minutes < 1440) return `${Math.floor(minutes/60)} hr`;
            return '1 day';
        }

        // ============================================
        // INITIALIZATION
        // ============================================

        function initApp() {
            try {
                loadSettings();
                loadData();
                applySettings();
                updateCurrentDate();
                initCalendar();
                loadTodoList();
                loadProjects();
                loadCalendarEvents();
                loadMotivationQuote();
                updateDashboardCounters();
                setupEventListeners();
                updateProjectDropdowns();
                
                // Set today's date for event input
                elements.eventDateInput.valueAsDate = new Date();
                elements.eventTimeInput.value = '09:00';
                
                // Set today's date for planner
                elements.plannerDate.value = new Date().toISOString().split('T')[0];
                state.selectedPlannerDate = elements.plannerDate.value;
                
                // Load saved session count
                const savedSessions = localStorage.getItem('pomodoroSessions');
                if (savedSessions) {
                    state.sessionsCompleted = parseInt(savedSessions);
                    elements.sessionCount.textContent = state.sessionsCompleted;
                }
                
                // Initialize task counter
                const maxTaskNumber = Math.max(...data.tasks.map(t => t.taskNumber || 0), 0);
                state.taskCounter = maxTaskNumber + 1;
                
                // Initialize planner
                loadPlannerData();
                loadHabits();
                renderHabitTracker();
                loadMatrixItems();
                
                // Load quick notes
                loadQuickNotes();
            } catch (error) {
                console.error('Error initializing app:', error);
                showToast('Error initializing app', 'error');
            }
        }

        // ============================================
        // SETTINGS MANAGEMENT
        // ============================================

        function loadSettings() {
            const saved = localStorage.getItem('productivityProSettings');
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    if (parsed.language) settings.language = parsed.language;
                    if (parsed.theme) settings.theme = parsed.theme;
                    if (parsed.viewMode) settings.viewMode = parsed.viewMode;
                    if (parsed.notifications !== undefined) settings.notifications = parsed.notifications;
                } catch (e) {
                    console.error('Error loading settings:', e);
                }
            }
        }

        function saveSettings() {
            localStorage.setItem('productivityProSettings', JSON.stringify(settings));
            applySettings();
        }

        function applySettings() {
            // Apply theme
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            let theme = settings.theme;
            
            if (theme === 'auto') {
                theme = prefersDark ? 'dark' : 'light';
            }
            
            document.documentElement.setAttribute('data-theme', theme);
            
            // Update theme toggle button
            const themeIcon = elements.themeToggleBtn.querySelector('i');
            if (theme === 'dark') {
                themeIcon.className = 'fas fa-moon';
                elements.themeToggleBtn.title = translations[settings.language]?.light || 'Switch to Light Mode';
            } else {
                themeIcon.className = 'fas fa-sun';
                elements.themeToggleBtn.title = translations[settings.language]?.dark || 'Switch to Dark Mode';
            }
            
            // Update active theme buttons
            elements.themeButtons.forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-theme') === settings.theme);
            });
            
            // Apply language
            document.documentElement.lang = settings.language;
            
            // Set direction based on language
            if (settings.language === 'ar') {
                document.documentElement.dir = 'rtl';
                document.body.dir = 'rtl';
            } else {
                document.documentElement.dir = 'ltr';
                document.body.dir = 'ltr';
            }
            
            // Translate page
            translatePage();
            
            // Update active language buttons
            elements.languageButtons.forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-lang') === settings.language);
            });
            
            // Apply view mode
            document.body.setAttribute('data-view', settings.viewMode);
            
            // Update active view buttons
            elements.viewButtons.forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-view') === settings.viewMode);
            });
            
            // Update view toggle button
            const viewIcon = elements.viewToggleBtn.querySelector('i');
            if (settings.viewMode === 'mobile') {
                viewIcon.className = 'fas fa-mobile-alt';
                elements.viewToggleBtn.title = translations[settings.language]?.desktop || 'Switch to Desktop View';
            } else {
                viewIcon.className = 'fas fa-desktop';
                elements.viewToggleBtn.title = translations[settings.language]?.mobile || 'Switch to Mobile View';
            }
            
            // Update language toggle button
            const langIcon = elements.languageToggleBtn.querySelector('i');
            if (settings.language === 'en') {
                langIcon.className = 'fas fa-language';
                elements.languageToggleBtn.title = '';
            } else {
                langIcon.className = 'fas fa-language';
                elements.languageToggleBtn.title = 'English';
            }
            
            // Re-render calendar if on calendar tab
            if (state.currentTab === 'calendar') {
                renderCalendar();
            }
            
            // Re-render habit tracker
            renderHabitTracker();
        }

        function translatePage() {
            const lang = settings.language;
            const t = translations[lang] || translations.en;
            
            // Translate all elements with data-i18n attribute
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (t[key]) {
                    element.textContent = t[key];
                }
            });
            
            // Translate all elements with data-i18n-placeholder attribute
            document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
                const key = element.getAttribute('data-i18n-placeholder');
                if (t[key]) {
                    element.placeholder = t[key];
                }
            });
            
            // Update calendar if needed
            if (state.currentTab === 'calendar') {
                updateCalendarHeaders();
            }
        }

        function updateCalendarHeaders() {
            if (elements.calendarMonth && translations[settings.language]) {
                const t = translations[settings.language];
                const year = state.currentCalendarDate.getFullYear();
                const month = state.currentCalendarDate.getMonth();
                const monthYear = `${t.months[month]} ${year}`;
                elements.calendarMonth.textContent = monthYear;
            }
        }

        // ============================================
        // DATA MANAGEMENT
        // ============================================

        function loadData() {
            try {
                // Load tasks
                const savedTasks = localStorage.getItem('tasks');
                data.tasks = savedTasks ? JSON.parse(savedTasks) : [...sampleData.tasks];
                
                // Load projects
                const savedProjects = localStorage.getItem('projects');
                data.projects = savedProjects ? JSON.parse(savedProjects) : [...sampleData.projects];
                
                // Load calendar events
                const savedEvents = localStorage.getItem('calendarEvents');
                data.calendarEvents = savedEvents ? JSON.parse(savedEvents) : [...sampleData.calendarEvents];
                
                // Load planner data
                const savedPlanner = localStorage.getItem('plannerData');
                data.plannerData = savedPlanner ? JSON.parse(savedPlanner) : {};
                
                // Load habits
                const savedHabits = localStorage.getItem('habits');
                data.habits = savedHabits ? JSON.parse(savedHabits) : [...sampleData.habits];
                
                // Load matrix items
                const savedMatrix = localStorage.getItem('matrixItems');
                data.matrixItems = savedMatrix ? JSON.parse(savedMatrix) : {...sampleData.matrixItems};
            } catch (e) {
                console.error('Error loading data:', e);
                data.tasks = [...sampleData.tasks];
                data.projects = [...sampleData.projects];
                data.calendarEvents = [...sampleData.calendarEvents];
                data.plannerData = {};
                data.habits = [...sampleData.habits];
                data.matrixItems = {...sampleData.matrixItems};
            }
        }

        function saveData() {
            try {
                localStorage.setItem('tasks', JSON.stringify(data.tasks));
                localStorage.setItem('projects', JSON.stringify(data.projects));
                localStorage.setItem('calendarEvents', JSON.stringify(data.calendarEvents));
                localStorage.setItem('plannerData', JSON.stringify(data.plannerData));
                localStorage.setItem('habits', JSON.stringify(data.habits));
                localStorage.setItem('matrixItems', JSON.stringify(data.matrixItems));
            } catch (e) {
                console.error('Error saving data:', e);
            }
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================

        function setupEventListeners() {
            // Settings panel
            elements.settingsBtn.addEventListener('click', () => elements.settingsPanel.classList.add('show'));
            elements.mobileSettingsBtn.addEventListener('click', () => elements.settingsPanel.classList.add('show'));
            elements.settingsNavBtn.addEventListener('click', () => {
                elements.settingsPanel.classList.add('show');
                closeMobileSidebar();
            });
            elements.closeSettingsBtn.addEventListener('click', () => elements.settingsPanel.classList.remove('show'));
            
            // Close settings when clicking outside
            document.addEventListener('click', (e) => {
                if (!elements.settingsPanel.contains(e.target) && 
                    e.target !== elements.settingsBtn &&
                    e.target !== elements.mobileSettingsBtn &&
                    !elements.mobileSettingsBtn.contains(e.target) &&
                    e.target !== elements.settingsNavBtn) {
                    elements.settingsPanel.classList.remove('show');
                }
            });
            
            // Theme toggle
            elements.themeToggleBtn.addEventListener('click', toggleTheme);
            elements.themeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    settings.theme = btn.getAttribute('data-theme');
                    saveSettings();
                });
            });
            
            // Language toggle
            elements.languageToggleBtn.addEventListener('click', toggleLanguage);
            elements.languageButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    settings.language = btn.getAttribute('data-lang');
                    saveSettings();
                    showToast(`Language changed to ${settings.language === 'en' ? 'English' : 'Arabic'}`, 'success');
                });
            });
            
            // View mode toggle
            elements.viewToggleBtn.addEventListener('click', toggleViewMode);
            elements.viewButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    settings.viewMode = btn.getAttribute('data-view');
                    saveSettings();
                });
            });
            
            // Navigation
            elements.navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tab = this.getAttribute('data-tab');
                    switchTab(tab);
                    closeMobileSidebar();
                });
            });
            
            // Mobile navigation
            elements.mobileNavItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const tab = this.getAttribute('data-tab');
                    switchTab(tab);
                    
                    elements.mobileNavItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Mobile menu
            elements.mobileMenuBtn.addEventListener('click', toggleMobileSidebar);
            
            // Calendar navigation
            elements.prevMonthBtn.addEventListener('click', () => changeMonth(-1));
            elements.nextMonthBtn.addEventListener('click', () => changeMonth(1));
            elements.todayBtn.addEventListener('click', goToToday);
            
            // Calendar events
            elements.addEventBtn.addEventListener('click', addCalendarEvent);
            elements.newEventInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addCalendarEvent();
            });
            
            // To-Do list
            elements.addTaskBtn.addEventListener('click', addNewTask);
            elements.newTaskInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addNewTask();
            });
            
            // Todo filters
            elements.filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    setFilter(filter);
                });
            });
            
            // Projects
            elements.addProjectBtn.addEventListener('click', addNewProject);
            elements.newProjectInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addNewProject();
            });
            
            // Timer
            elements.startTimerBtn.addEventListener('click', startTimer);
            elements.pauseTimerBtn.addEventListener('click', pauseTimer);
            elements.resetTimerBtn.addEventListener('click', resetTimer);
            elements.newQuoteBtn.addEventListener('click', loadMotivationQuote);
            
            // Timer presets
            elements.timerPresets.forEach(preset => {
                preset.addEventListener('click', function() {
                    const minutes = parseInt(this.getAttribute('data-minutes'));
                    setTimer(minutes);
                });
            });
            
            // Edit Modals
            elements.closeTaskModal.addEventListener('click', closeTaskEditModal);
            elements.cancelTaskEdit.addEventListener('click', closeTaskEditModal);
            elements.taskEditForm.addEventListener('submit', saveTaskEdit);
            
            elements.closeProjectModal.addEventListener('click', closeProjectEditModal);
            elements.cancelProjectEdit.addEventListener('click', closeProjectEditModal);
            elements.projectEditForm.addEventListener('submit', saveProjectEdit);
            
            // Habit Edit Modal
            elements.closeHabitModal.addEventListener('click', closeHabitEditModal);
            elements.cancelHabitEdit.addEventListener('click', closeHabitEditModal);
            elements.habitEditForm.addEventListener('submit', saveHabitEdit);
            
            // Data management
            elements.clearDataBtn.addEventListener('click', clearAllData);
            elements.exportDataBtn.addEventListener('click', exportData);
            elements.importDataBtn.addEventListener('click', () => elements.importFileInput.click());
            elements.importFileInput.addEventListener('change', importData);
            
            // NEW: Planner event listeners
            elements.plannerDate.addEventListener('change', function() {
                state.selectedPlannerDate = this.value;
                loadPlannerData();
                loadPlannerTasks();
            });
            
            elements.saveGoalsBtn.addEventListener('click', saveDailyGoals);
            elements.addTimeBlockBtn.addEventListener('click', addTimeBlock);
            elements.saveNotesBtn.addEventListener('click', savePlannerNotes);
            
            // NEW: Focus tools event listeners
            elements.addHabitBtn.addEventListener('click', addNewHabit);
            elements.newHabitInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addNewHabit();
            });
            
            elements.saveQuickNotesBtn.addEventListener('click', saveQuickNotes);
            
            // Matrix add buttons
            document.querySelectorAll('.matrix-add-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const quadrant = this.getAttribute('data-quadrant');
                    const input = this.previousElementSibling;
                    addMatrixItem(quadrant, input.value);
                    input.value = '';
                });
            });
            
            // Matrix input enter key
            document.querySelectorAll('.matrix-input').forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const quadrant = this.getAttribute('data-quadrant');
                        addMatrixItem(quadrant, this.value);
                        this.value = '';
                    }
                });
            });
            
            // Matrix drag and drop
            setupMatrixDragAndDrop();
            
            // Close modals with Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    if (elements.taskEditModal.style.display === 'flex') closeTaskEditModal();
                    if (elements.projectEditModal.style.display === 'flex') closeProjectEditModal();
                    if (elements.habitEditModal.style.display === 'flex') closeHabitEditModal();
                    if (elements.settingsPanel.classList.contains('show')) elements.settingsPanel.classList.remove('show');
                }
            });
            
            // Window resize
            window.addEventListener('resize', handleResize);
        }

        // ============================================
        // TOGGLE FUNCTIONS
        // ============================================

        function toggleTheme() {
            if (settings.theme === 'light') settings.theme = 'dark';
            else if (settings.theme === 'dark') settings.theme = 'auto';
            else settings.theme = 'light';
            saveSettings();
        }

        function toggleLanguage() {
            settings.language = settings.language === 'en' ? 'ar' : 'en';
            saveSettings();
        }

        function toggleViewMode() {
            if (settings.viewMode === 'auto') settings.viewMode = 'mobile';
            else if (settings.viewMode === 'mobile') settings.viewMode = 'desktop';
            else settings.viewMode = 'auto';
            saveSettings();
            
            // Show appropriate message
            const t = translations[settings.language] || translations.en;
            let message = '';
            if (settings.viewMode === 'desktop') {
                message = 'Desktop view enabled. Sidebar is collapsible on mobile.';
                if (window.innerWidth <= 768) {
                    // On mobile, show the sidebar initially
                    elements.sidebar.style.display = 'flex';
                }
            } else if (settings.viewMode === 'mobile') {
                message = 'Mobile view enabled. Using mobile-optimized layout.';
            } else {
                message = 'Auto view mode enabled. Layout adjusts based on screen size.';
            }
            showToast(message, 'info');
        }

        // ============================================
        // MOBILE FUNCTIONS
        // ============================================

        function toggleMobileSidebar() {
            elements.sidebar.classList.toggle('show');
            if (elements.sidebar.classList.contains('show')) {
                createOverlay();
            } else {
                removeOverlay();
            }
        }

        function closeMobileSidebar() {
            elements.sidebar.classList.remove('show');
            removeOverlay();
        }

        function createOverlay() {
            if (!document.querySelector('.sidebar-overlay')) {
                const overlay = document.createElement('div');
                overlay.className = 'sidebar-overlay';
                overlay.addEventListener('click', closeMobileSidebar);
                document.body.appendChild(overlay);
            }
        }

        function removeOverlay() {
            const overlay = document.querySelector('.sidebar-overlay');
            if (overlay) overlay.remove();
        }

        function handleResize() {
            // Update calendar view based on screen size
            if (state.currentTab === 'calendar') {
                renderCalendar();
            }
            
            // Handle auto view mode
            if (settings.viewMode === 'auto') {
                if (window.innerWidth <= 768) {
                    // Auto switch to mobile layout
                    closeMobileSidebar();
                    removeOverlay();
                }
            } else if (settings.viewMode === 'desktop') {
                // Ensure sidebar is visible in desktop mode on mobile
                if (window.innerWidth <= 768) {
                    elements.sidebar.style.display = 'flex';
                }
            }
        }

        // ============================================
        // TAB MANAGEMENT
        // ============================================

        function switchTab(tabName) {
            // Update desktop navigation
            elements.navItems.forEach(item => {
                item.classList.toggle('active', item.getAttribute('data-tab') === tabName);
            });
            
            // Update tab content
            elements.tabContents.forEach(content => {
                content.classList.toggle('active', content.id === tabName);
            });
            
            // Update page title
            const t = translations[settings.language] || translations.en;
            elements.pageTitle.textContent = t[tabName] || tabName;
            state.currentTab = tabName;
            
            // Refresh specific tab
            if (tabName === 'calendar') {
                renderCalendar();
                loadCalendarEvents();
            } else if (tabName === 'dashboard') {
                updateDashboardTodoList();
            } else if (tabName === 'projects') {
                updateProjectDropdowns();
            } else if (tabName === 'planner') {
                loadPlannerData();
                loadPlannerTasks();
            } else if (tabName === 'procrastination') {
                loadHabits();
                renderHabitTracker();
                loadMatrixItems();
            }
        }

        // ============================================
        // DATE AND TIME
        // ============================================

        function updateCurrentDate() {
            const now = new Date();
            const t = translations[settings.language] || translations.en;
            
            // For Arabic, use Arabic locale
            const locale = settings.language === 'ar' ? 'ar-SA' : 'en-US';
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const shortOptions = { month: 'short', day: 'numeric' };
            
            elements.currentDate.textContent = now.toLocaleDateString(locale, options);
            elements.mobileDate.textContent = now.toLocaleDateString(locale, shortOptions);
        }

        // ============================================
        // CALENDAR FUNCTIONS
        // ============================================

        function initCalendar() {
            renderCalendar();
        }

        function renderCalendar() {
            // Clear existing calendar
            elements.calendarGrid.innerHTML = '';
            elements.calendarWeekView.innerHTML = '';
            
            const t = translations[settings.language] || translations.en;
            const year = state.currentCalendarDate.getFullYear();
            const month = state.currentCalendarDate.getMonth();
            
            // Update month display
            const monthYear = `${t.months[month]} ${year}`;
            elements.calendarMonth.textContent = monthYear;
            
            // Get first day of month and total days
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const totalDays = lastDay.getDate();
            const startingDay = firstDay.getDay();
            
            // Create day headers
            for (let i = 0; i < 7; i++) {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = t.days[i];
                elements.calendarGrid.appendChild(dayHeader);
            }
            
            // Create empty cells for days before the first day of the month
            for (let i = 0; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                elements.calendarGrid.appendChild(emptyDay);
            }
            
            // Create cells for each day of the month
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            for (let day = 1; day <= totalDays; day++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';
                
                // Check if this is today
                const cellDate = new Date(year, month, day);
                if (cellDate.getTime() === today.getTime()) {
                    dayCell.classList.add('today');
                }
                
                // Add day number
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayCell.appendChild(dayNumber);
                
                // Add events for this day
                const dateStr = `${year}-${(month + 1).toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
                const dayEvents = data.calendarEvents.filter(event => event.date === dateStr);
                
                // Add tasks for this day
                const dayTasks = data.tasks.filter(task => task.dueDate === dateStr);
                
                // Add events to day cell
                dayEvents.forEach(event => {
                    const eventEl = document.createElement('div');
                    eventEl.className = 'calendar-event';
                    eventEl.textContent = event.title;
                    eventEl.title = `${event.title} at ${formatTime(event.time)}`;
                    
                    if (event.reminder) {
                        const reminderSpan = document.createElement('span');
                        reminderSpan.className = 'calendar-event-reminder';
                        reminderSpan.textContent = ` ${getReminderText(event.reminder)}`;
                        eventEl.appendChild(reminderSpan);
                    }
                    
                    dayCell.appendChild(eventEl);
                });
                
                // Add task count
                if (dayTasks.length > 0) {
                    const taskEl = document.createElement('div');
                    taskEl.className = 'calendar-event';
                    taskEl.style.backgroundColor = 'var(--primary-dark)';
                    taskEl.innerHTML = `<span class="task-number">${dayTasks.length}</span> ${dayTasks.length === 1 ? 'task' : 'tasks'}`;
                    dayCell.appendChild(taskEl);
                }
                
                elements.calendarGrid.appendChild(dayCell);
                
                // Also add to week view if it's within the current week
                const dayOfWeek = cellDate.getDay();
                const weekStart = new Date(today);
                weekStart.setDate(today.getDate() - today.getDay());
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                
                if (cellDate >= weekStart && cellDate <= weekEnd) {
                    const weekDay = document.createElement('div');
                    weekDay.className = 'calendar-week-day';
                    if (cellDate.getTime() === today.getTime()) {
                        weekDay.classList.add('today');
                    }
                    
                    const weekDayNumber = document.createElement('div');
                    weekDayNumber.className = 'day-number';
                    weekDayNumber.innerHTML = `<strong>${t.days[dayOfWeek]}</strong><br>${day}`;
                    weekDay.appendChild(weekDayNumber);
                    
                    // Add events to week view
                    dayEvents.forEach(event => {
                        const eventEl = document.createElement('div');
                        eventEl.className = 'calendar-event';
                        eventEl.textContent = event.title;
                        weekDay.appendChild(eventEl);
                    });
                    
                    elements.calendarWeekView.appendChild(weekDay);
                }
            }
            
            // Show appropriate view based on screen size
            if (window.innerWidth <= 768 && settings.viewMode !== 'desktop') {
                elements.calendarGrid.style.display = 'none';
                elements.calendarWeekView.style.display = 'flex';
            } else {
                elements.calendarGrid.style.display = 'grid';
                elements.calendarWeekView.style.display = 'none';
            }
        }

        function changeMonth(delta) {
            state.currentCalendarDate.setMonth(state.currentCalendarDate.getMonth() + delta);
            renderCalendar();
        }

        function goToToday() {
            state.currentCalendarDate = new Date();
            renderCalendar();
        }

        // ============================================
        // TO-DO LIST FUNCTIONS
        // ============================================

        function loadTodoList() {
            updateTodoList();
        }

        function updateTodoList() {
            elements.todoList.innerHTML = '';
            
            let filteredTasks = [...data.tasks];
            
            // Apply filter
            switch (state.currentFilter) {
                case 'active':
                    filteredTasks = filteredTasks.filter(task => !task.completed);
                    break;
                case 'completed':
                    filteredTasks = filteredTasks.filter(task => task.completed);
                    break;
                case 'priority':
                    filteredTasks = filteredTasks.filter(task => task.priority === 'high' || task.priority === 'medium');
                    break;
                case 'high':
                    filteredTasks = filteredTasks.filter(task => task.priority === 'high');
                    break;
            }
            
            // Sort tasks: incomplete first, then by priority, then by creation date
            filteredTasks.sort((a, b) => {
                if (a.completed !== b.completed) return a.completed ? 1 : -1;
                
                const priorityOrder = { 'high': 0, 'medium': 1, 'low': 2, 'none': 3 };
                if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                    return priorityOrder[a.priority] - priorityOrder[b.priority];
                }
                
                return a.id - b.id;
            });
            
            if (filteredTasks.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-clipboard-list"></i>
                    <p data-i18n="noTasks">No tasks found</p>
                `;
                elements.todoList.appendChild(emptyState);
                return;
            }
            
            filteredTasks.forEach(task => {
                const taskItem = createTaskElement(task);
                elements.todoList.appendChild(taskItem);
            });
            
            updateDashboardTodoList();
            updateDashboardCounters();
        }

        function createTaskElement(task) {
            const li = document.createElement('li');
            li.className = `todo-item ${task.completed ? 'completed' : ''}`;
            li.dataset.taskId = task.id;
            
            // Priority indicator
            const priorityIndicator = document.createElement('div');
            priorityIndicator.className = `priority-indicator priority-${task.priority}`;
            
            // Checkbox
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.className = 'todo-checkbox';
            checkbox.checked = task.completed;
            checkbox.addEventListener('change', () => toggleTaskComplete(task.id));
            
            // Task text
            const taskText = document.createElement('div');
            taskText.className = 'todo-text';
            taskText.textContent = task.text;
            
            // Task number
            if (task.taskNumber) {
                const taskNumberSpan = document.createElement('span');
                taskNumberSpan.className = 'task-number';
                taskNumberSpan.textContent = `#${task.taskNumber}`;
                taskText.prepend(taskNumberSpan);
                taskText.prepend(document.createTextNode(' '));
            }
            
            // Project link if applicable
            if (task.projectId) {
                const project = data.projects.find(p => p.id === task.projectId);
                if (project) {
                    const projectLink = document.createElement('span');
                    projectLink.className = 'task-project-link';
                    projectLink.innerHTML = `<i class="fas fa-project-diagram"></i> ${project.title}`;
                    projectLink.addEventListener('click', () => {
                        switchTab('projects');
                    });
                    taskText.appendChild(projectLink);
                }
            }
            
            // Due date if applicable
            if (task.dueDate) {
                const dueDate = new Date(task.dueDate);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const dueDateSpan = document.createElement('span');
                dueDateSpan.className = 'task-due-date';
                dueDateSpan.style.marginLeft = '10px';
                dueDateSpan.style.fontSize = '12px';
                dueDateSpan.style.color = 'var(--text-secondary)';
                
                if (dueDate.getTime() === today.getTime()) {
                    dueDateSpan.textContent = 'Today';
                    dueDateSpan.style.color = 'var(--primary)';
                } else if (dueDate < today && !task.completed) {
                    dueDateSpan.textContent = 'Overdue';
                    dueDateSpan.style.color = 'var(--danger)';
                } else {
                    const options = { month: 'short', day: 'numeric' };
                    dueDateSpan.textContent = dueDate.toLocaleDateString(undefined, options);
                }
                
                taskText.appendChild(dueDateSpan);
            }
            
            // Actions
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'todo-actions';
            
            const editBtn = document.createElement('button');
            editBtn.innerHTML = '<i class="fas fa-edit"></i>';
            editBtn.title = 'Edit task';
            editBtn.addEventListener('click', () => openTaskEditModal(task.id));
            
            const deleteBtn = document.createElement('button');
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.title = 'Delete task';
            deleteBtn.addEventListener('click', () => deleteTask(task.id));
            
            actionsDiv.appendChild(editBtn);
            actionsDiv.appendChild(deleteBtn);
            
            li.appendChild(priorityIndicator);
            li.appendChild(checkbox);
            li.appendChild(taskText);
            li.appendChild(actionsDiv);
            
            return li;
        }

        function addNewTask() {
            const taskText = elements.newTaskInput.value.trim();
            if (!taskText) {
                const t = translations[settings.language] || translations.en;
                showToast(t.enterTask, 'error');
                return;
            }
            
            const newTask = {
                id: Date.now(),
                text: taskText,
                completed: false,
                priority: elements.taskPrioritySelect.value,
                projectId: elements.taskProjectSelect.value ? parseInt(elements.taskProjectSelect.value) : null,
                dueDate: null,
                taskNumber: state.taskCounter++
            };
            
            data.tasks.push(newTask);
            saveData();
            
            elements.newTaskInput.value = '';
            elements.taskPrioritySelect.value = 'none';
            elements.taskProjectSelect.value = '';
            
            updateTodoList();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.taskAdded, 'success');
        }

        function toggleTaskComplete(taskId) {
            const task = data.tasks.find(t => t.id === taskId);
            if (task) {
                task.completed = !task.completed;
                saveData();
                updateTodoList();
                
                if (state.currentTab === 'dashboard') {
                    updateDashboardTodoList();
                }
                
                if (state.currentTab === 'planner') {
                    loadPlannerTasks();
                }
            }
        }

        function deleteTask(taskId) {
            data.tasks = data.tasks.filter(t => t.id !== taskId);
            saveData();
            updateTodoList();
            
            if (state.currentTab === 'dashboard') {
                updateDashboardTodoList();
            }
            
            if (state.currentTab === 'planner') {
                loadPlannerTasks();
            }
        }

        function setFilter(filter) {
            state.currentFilter = filter;
            
            // Update active filter button
            elements.filterButtons.forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-filter') === filter);
            });
            
            updateTodoList();
        }

        // ============================================
        // TASK EDIT MODAL FUNCTIONS
        // ============================================

        function openTaskEditModal(taskId) {
            const task = data.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            state.editingTaskId = taskId;
            
            elements.editTaskText.value = task.text;
            elements.editTaskPriority.value = task.priority;
            elements.editTaskProject.value = task.projectId || '';
            elements.editTaskDueDate.value = task.dueDate || '';
            elements.editTaskTime.value = task.time || '';
            
            elements.taskEditModal.style.display = 'flex';
        }

        function closeTaskEditModal() {
            elements.taskEditModal.style.display = 'none';
            state.editingTaskId = null;
        }

        function saveTaskEdit(e) {
            e.preventDefault();
            
            const task = data.tasks.find(t => t.id === state.editingTaskId);
            if (!task) return;
            
            task.text = elements.editTaskText.value.trim();
            task.priority = elements.editTaskPriority.value;
            task.projectId = elements.editTaskProject.value ? parseInt(elements.editTaskProject.value) : null;
            task.dueDate = elements.editTaskDueDate.value || null;
            
            saveData();
            updateTodoList();
            closeTaskEditModal();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.taskUpdated, 'success');
        }

        // ============================================
        // DASHBOARD FUNCTIONS
        // ============================================

        function updateDashboardCounters() {
            const today = new Date().toISOString().split('T')[0];
            
            // Today's tasks
            const todayTasks = data.tasks.filter(task => task.dueDate === today && !task.completed);
            elements.todayTasksCount.textContent = todayTasks.length;
            
            // Completed tasks
            const completedTasks = data.tasks.filter(task => task.completed);
            elements.completedTasksCount.textContent = completedTasks.length;
            
            // Active projects
            const activeProjects = data.projects.filter(project => project.status === 'active');
            elements.activeProjectsCount.textContent = activeProjects.length;
            
            // Productivity score (simplified)
            const totalTasks = data.tasks.length;
            const score = totalTasks > 0 ? Math.round((completedTasks.length / totalTasks) * 100) : 0;
            elements.productivityScore.textContent = `${score}%`;
        }

        function updateDashboardTodoList() {
            elements.dashboardTodoList.innerHTML = '';
            
            const today = new Date().toISOString().split('T')[0];
            const todayTasks = data.tasks.filter(task => 
                (task.dueDate === today || !task.dueDate) && 
                !task.completed && 
                (task.priority === 'high' || task.priority === 'medium')
            ).slice(0, 5); // Limit to 5 tasks
            
            if (todayTasks.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <p data-i18n="noPriorityTasks">No priority tasks for today</p>
                `;
                elements.dashboardTodoList.appendChild(emptyState);
                return;
            }
            
            todayTasks.forEach(task => {
                const taskItem = createTaskElement(task);
                elements.dashboardTodoList.appendChild(taskItem);
            });
        }

        // ============================================
        // CALENDAR EVENTS FUNCTIONS
        // ============================================

        function loadCalendarEvents() {
            elements.calendarEventsList.innerHTML = '';
            
            // Sort events by date and time
            const sortedEvents = [...data.calendarEvents].sort((a, b) => {
                const dateCompare = new Date(a.date).getTime() - new Date(b.date).getTime();
                if (dateCompare !== 0) return dateCompare;
                
                const timeA = a.time ? a.time.split(':').map(Number) : [0, 0];
                const timeB = b.time ? b.time.split(':').map(Number) : [0, 0];
                return (timeA[0] * 60 + timeA[1]) - (timeB[0] * 60 + timeB[1]);
            });
            
            if (sortedEvents.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-calendar"></i>
                    <p data-i18n="noEvents">No calendar events</p>
                `;
                elements.calendarEventsList.appendChild(emptyState);
                return;
            }
            
            sortedEvents.forEach(event => {
                const eventItem = document.createElement('li');
                eventItem.className = 'todo-item';
                eventItem.dataset.eventId = event.id;
                
                const eventText = document.createElement('div');
                eventText.className = 'todo-text';
                eventText.innerHTML = `
                    <strong>${event.title}</strong>
                    <div style="font-size: 14px; color: var(--text-secondary); margin-top: 5px;">
                        <i class="fas fa-calendar"></i> ${new Date(event.date).toLocaleDateString()}
                        ${event.time ? `  <i class="fas fa-clock"></i> ${formatTime(event.time)}` : ''}
                        ${event.reminder ? `  <i class="fas fa-bell"></i> ${getReminderText(event.reminder)} before` : ''}
                    </div>
                `;
                
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'todo-actions';
                
                const deleteBtn = document.createElement('button');
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
                deleteBtn.title = 'Delete event';
                deleteBtn.addEventListener('click', () => deleteCalendarEvent(event.id));
                
                actionsDiv.appendChild(deleteBtn);
                
                eventItem.appendChild(eventText);
                eventItem.appendChild(actionsDiv);
                
                elements.calendarEventsList.appendChild(eventItem);
            });
        }

        function addCalendarEvent() {
            const title = elements.newEventInput.value.trim();
            const date = elements.eventDateInput.value;
            const time = elements.eventTimeInput.value;
            const reminder = elements.eventReminderSelect.value;
            
            const t = translations[settings.language] || translations.en;
            
            if (!title) {
                showToast(t.enterEvent, 'error');
                return;
            }
            
            if (!date) {
                showToast(t.selectDate, 'error');
                return;
            }
            
            const newEvent = {
                id: Date.now(),
                title: title,
                date: date,
                time: time || null,
                reminder: reminder ? parseInt(reminder) : null,
                type: 'event'
            };
            
            data.calendarEvents.push(newEvent);
            saveData();
            
            elements.newEventInput.value = '';
            elements.eventDateInput.valueAsDate = new Date();
            elements.eventTimeInput.value = '09:00';
            elements.eventReminderSelect.value = '';
            
            loadCalendarEvents();
            renderCalendar();
            
            showToast(t.eventAdded, 'success');
        }

        function deleteCalendarEvent(eventId) {
            data.calendarEvents = data.calendarEvents.filter(e => e.id !== eventId);
            saveData();
            loadCalendarEvents();
            renderCalendar();
        }

        // ============================================
        // PROJECTS FUNCTIONS
        // ============================================

        function loadProjects() {
            updateProjectsGrid();
        }

        function updateProjectsGrid() {
            elements.projectsGrid.innerHTML = '';
            
            if (data.projects.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-project-diagram"></i>
                    <p data-i18n="noProjects">No projects yet</p>
                    <p style="font-size: 14px; margin-top: 10px;" data-i18n="createFirstProject">Create your first project to get started</p>
                `;
                elements.projectsGrid.appendChild(emptyState);
                return;
            }
            
            data.projects.forEach(project => {
                const projectCard = createProjectElement(project);
                elements.projectsGrid.appendChild(projectCard);
            });
        }

        function createProjectElement(project) {
            const card = document.createElement('div');
            card.className = 'project-card';
            card.dataset.projectId = project.id;
            
            // Project header
            const headerDiv = document.createElement('div');
            headerDiv.className = 'project-header';
            
            const titleDiv = document.createElement('div');
            titleDiv.className = 'project-title';
            titleDiv.textContent = project.title;
            
            const statusDiv = document.createElement('div');
            statusDiv.className = `project-status ${project.status}`;
            statusDiv.textContent = project.status === 'active' ? 'Active' : 'Completed';
            
            headerDiv.appendChild(titleDiv);
            headerDiv.appendChild(statusDiv);
            
            // Project description
            const descDiv = document.createElement('div');
            descDiv.className = 'project-description';
            descDiv.textContent = project.description;
            
            // Project files
            const filesDiv = document.createElement('div');
            filesDiv.className = 'project-files';
            
            if (project.files && project.files.length > 0) {
                project.files.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <i class="fas fa-paperclip"></i>
                        <span>${file}</span>
                    `;
                    filesDiv.appendChild(fileItem);
                });
            } else {
                const noFiles = document.createElement('div');
                noFiles.className = 'file-item';
                noFiles.innerHTML = `
                    <i class="fas fa-file"></i>
                    <span data-i18n="noFiles">No files attached</span>
                `;
                filesDiv.appendChild(noFiles);
            }
            
            // Project tasks
            const tasksDiv = document.createElement('div');
            tasksDiv.className = 'project-tasks';
            
            const tasksHeader = document.createElement('h4');
            tasksHeader.innerHTML = `<i class="fas fa-tasks"></i> <span data-i18n="projectTasks">Project Tasks</span>`;
            
            const tasksList = document.createElement('div');
            tasksList.className = 'project-tasks-list';
            
            const projectTasks = data.tasks.filter(task => task.projectId === project.id);
            projectTasks.forEach(task => {
                const taskItem = document.createElement('div');
                taskItem.className = `project-task-item ${task.completed ? 'completed' : ''}`;
                taskItem.innerHTML = `
                    <input type="checkbox" ${task.completed ? 'checked' : ''} onchange="toggleTaskComplete(${task.id})">
                    <span>${task.text}</span>
                `;
                tasksList.appendChild(taskItem);
            });
            
            if (projectTasks.length === 0) {
                const noTasks = document.createElement('div');
                noTasks.className = 'empty-state';
                noTasks.style.padding = '10px';
                noTasks.innerHTML = `<p data-i18n="noProjectTasks">No tasks in this project</p>`;
                tasksList.appendChild(noTasks);
            }
            
            tasksDiv.appendChild(tasksHeader);
            tasksDiv.appendChild(tasksList);
            
            // Project actions
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'project-actions';
            
            const editBtn = document.createElement('button');
            editBtn.className = 'btn';
            editBtn.innerHTML = '<i class="fas fa-edit"></i> <span data-i18n="edit">Edit</span>';
            editBtn.addEventListener('click', () => openProjectEditModal(project.id));
            
            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'btn btn-danger';
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i> <span data-i18n="delete">Delete</span>';
            deleteBtn.addEventListener('click', () => deleteProject(project.id));
            
            actionsDiv.appendChild(editBtn);
            actionsDiv.appendChild(deleteBtn);
            
            // File upload
            const uploadDiv = document.createElement('div');
            uploadDiv.className = 'file-upload';
            uploadDiv.innerHTML = `
                <i class="fas fa-cloud-upload-alt"></i>
                <p data-i18n="uploadFiles">Click to upload files</p>
                <input type="file" multiple>
            `;
            
            const fileInput = uploadDiv.querySelector('input');
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    const files = Array.from(e.target.files).map(f => f.name);
                    if (!project.files) project.files = [];
                    project.files.push(...files);
                    saveData();
                    updateProjectsGrid();
                    
                    const t = translations[settings.language] || translations.en;
                    showToast(`${files.length} ${t.fileAdded}`, 'success');
                }
            });
            
            // Assemble card
            card.appendChild(headerDiv);
            card.appendChild(descDiv);
            card.appendChild(filesDiv);
            card.appendChild(uploadDiv);
            card.appendChild(tasksDiv);
            card.appendChild(actionsDiv);
            
            return card;
        }

        function addNewProject() {
            const title = elements.newProjectInput.value.trim();
            if (!title) {
                const t = translations[settings.language] || translations.en;
                showToast(t.enterProjectName, 'error');
                return;
            }
            
            const newProject = {
                id: Date.now(),
                title: title,
                description: '',
                status: 'active',
                files: []
            };
            
            data.projects.push(newProject);
            saveData();
            
            elements.newProjectInput.value = '';
            updateProjectsGrid();
            updateProjectDropdowns();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.projectAdded, 'success');
        }

        function updateProjectDropdowns() {
            // Update dropdown in todo tab
            elements.taskProjectSelect.innerHTML = '<option value="">No Project</option>';
            // Update dropdown in task edit modal
            elements.editTaskProject.innerHTML = '<option value="">No Project</option>';
            
            data.projects.forEach(project => {
                const option1 = document.createElement('option');
                option1.value = project.id;
                option1.textContent = project.title;
                elements.taskProjectSelect.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = project.id;
                option2.textContent = project.title;
                elements.editTaskProject.appendChild(option2);
            });
        }

        function openProjectEditModal(projectId) {
            const project = data.projects.find(p => p.id === projectId);
            if (!project) return;
            
            state.editingProjectId = projectId;
            
            elements.editProjectTitle.value = project.title;
            elements.editProjectDescription.value = project.description || '';
            elements.editProjectStatus.value = project.status;
            
            elements.projectEditModal.style.display = 'flex';
        }

        function closeProjectEditModal() {
            elements.projectEditModal.style.display = 'none';
            state.editingProjectId = null;
        }

        function saveProjectEdit(e) {
            e.preventDefault();
            
            const project = data.projects.find(p => p.id === state.editingProjectId);
            if (!project) return;
            
            project.title = elements.editProjectTitle.value.trim();
            project.description = elements.editProjectDescription.value.trim();
            project.status = elements.editProjectStatus.value;
            
            saveData();
            updateProjectsGrid();
            updateProjectDropdowns();
            closeProjectEditModal();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.projectUpdated, 'success');
        }

        function deleteProject(projectId) {
            const t = translations[settings.language] || translations.en;
            if (!confirm(t.confirmDeleteProject)) return;
            
            // Unlink tasks from this project
            data.tasks.forEach(task => {
                if (task.projectId === projectId) {
                    task.projectId = null;
                }
            });
            
            data.projects = data.projects.filter(p => p.id !== projectId);
            saveData();
            
            updateProjectsGrid();
            updateProjectDropdowns();
            updateTodoList();
            
            showToast(t.projectDeleted, 'success');
        }

        // ============================================
        // PLANNER FUNCTIONS
        // ============================================

        function loadPlannerData() {
            const dateKey = state.selectedPlannerDate;
            
            if (!data.plannerData[dateKey]) {
                data.plannerData[dateKey] = {
                    goals: '',
                    notes: '',
                    timeBlocks: []
                };
            }
            
            const planner = data.plannerData[dateKey];
            
            // Load goals
            elements.dailyGoals.value = planner.goals || '';
            
            // Load notes
            elements.plannerNotes.value = planner.notes || '';
            
            // Load time blocks
            renderTimeBlocks();
            
            // Load tasks for this date
            loadPlannerTasks();
        }

        function loadPlannerTasks() {
            elements.plannerTasksList.innerHTML = '';
            
            const tasks = data.tasks.filter(task => {
                if (!task.dueDate) return false;
                return task.dueDate === state.selectedPlannerDate;
            });
            
            if (tasks.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.style.padding = '20px';
                emptyState.innerHTML = `
                    <i class="fas fa-tasks"></i>
                    <p data-i18n="noTasksForDate">No tasks for this date</p>
                `;
                elements.plannerTasksList.appendChild(emptyState);
                return;
            }
            
            tasks.forEach(task => {
                const taskItem = document.createElement('div');
                taskItem.className = `todo-item ${task.completed ? 'completed' : ''}`;
                taskItem.style.marginBottom = '8px';
                taskItem.innerHTML = `
                    <input type="checkbox" class="todo-checkbox" ${task.completed ? 'checked' : ''}>
                    <div class="todo-text">${task.text}</div>
                `;
                
                const checkbox = taskItem.querySelector('input');
                checkbox.addEventListener('change', () => {
                    toggleTaskComplete(task.id);
                    loadPlannerTasks();
                });
                
                elements.plannerTasksList.appendChild(taskItem);
            });
        }

        function saveDailyGoals() {
            const dateKey = state.selectedPlannerDate;
            
            if (!data.plannerData[dateKey]) {
                data.plannerData[dateKey] = {};
            }
            
            data.plannerData[dateKey].goals = elements.dailyGoals.value;
            saveData();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.goalsSaved, 'success');
        }

        function savePlannerNotes() {
            const dateKey = state.selectedPlannerDate;
            
            if (!data.plannerData[dateKey]) {
                data.plannerData[dateKey] = {};
            }
            
            data.plannerData[dateKey].notes = elements.plannerNotes.value;
            saveData();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.notesSaved, 'success');
        }

        function renderTimeBlocks() {
            elements.timeBlocks.innerHTML = '';
            
            const dateKey = state.selectedPlannerDate;
            const timeBlocks = data.plannerData[dateKey]?.timeBlocks || [];
            
            if (timeBlocks.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.style.padding = '20px';
                emptyState.innerHTML = `
                    <i class="fas fa-clock"></i>
                    <p data-i18n="noTimeBlocks">No time blocks for today</p>
                    <p style="font-size: 14px; margin-top: 10px;" data-i18n="addTimeBlocks">Add time blocks to plan your day</p>
                `;
                elements.timeBlocks.appendChild(emptyState);
                return;
            }
            
            // Sort time blocks by time
            timeBlocks.sort((a, b) => {
                const timeA = a.time.split(':').map(Number);
                const timeB = b.time.split(':').map(Number);
                return (timeA[0] * 60 + timeA[1]) - (timeB[0] * 60 + timeB[1]);
            });
            
            timeBlocks.forEach((block, index) => {
                const timeBlockEl = createTimeBlockElement(block, index);
                elements.timeBlocks.appendChild(timeBlockEl);
            });
        }

        function createTimeBlockElement(block, index) {
            const div = document.createElement('div');
            div.className = 'time-block';
            
            const timeDiv = document.createElement('div');
            timeDiv.className = 'time-block-time';
            timeDiv.textContent = formatTime(block.time);
            
            const taskDiv = document.createElement('div');
            taskDiv.className = 'time-block-task';
            
            const input = document.createElement('input');
            input.type = 'text';
            input.value = block.task;
            input.placeholder = 'What are you working on?';
            input.addEventListener('change', () => {
                updateTimeBlockTask(index, input.value);
            });
            
            taskDiv.appendChild(input);
            
            const statusDiv = document.createElement('div');
            statusDiv.className = 'time-block-status';
            
            const statusDot = document.createElement('div');
            statusDot.className = `status-dot ${block.status}`;
            statusDot.title = block.status === 'completed' ? 'Completed' : 
                            block.status === 'in-progress' ? 'In Progress' : 'Not Started';
            
            const statusText = document.createElement('span');
            statusText.textContent = block.status === 'completed' ? 'Done' : 
                                   block.status === 'in-progress' ? 'In Progress' : 'Not Started';
            statusText.style.fontSize = '12px';
            statusText.style.color = 'var(--text-secondary)';
            
            statusDiv.appendChild(statusDot);
            statusDiv.appendChild(statusText);
            
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'time-block-actions';
            
            const completeBtn = document.createElement('button');
            completeBtn.innerHTML = '<i class="fas fa-check"></i>';
            completeBtn.title = 'Mark as completed';
            completeBtn.addEventListener('click', () => {
                toggleTimeBlockStatus(index);
            });
            
            const deleteBtn = document.createElement('button');
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.title = 'Delete time block';
            deleteBtn.className = 'delete-time-block';
            deleteBtn.addEventListener('click', () => {
                deleteTimeBlock(index);
            });
            
            actionsDiv.appendChild(completeBtn);
            actionsDiv.appendChild(deleteBtn);
            
            div.appendChild(timeDiv);
            div.appendChild(taskDiv);
            div.appendChild(statusDiv);
            div.appendChild(actionsDiv);
            
            return div;
        }

        function addTimeBlock() {
            const dateKey = state.selectedPlannerDate;
            
            if (!data.plannerData[dateKey]) {
                data.plannerData[dateKey] = { timeBlocks: [] };
            }
            
            if (!data.plannerData[dateKey].timeBlocks) {
                data.plannerData[dateKey].timeBlocks = [];
            }
            
            // Default to next hour
            const now = new Date();
            const nextHour = new Date(now);
            nextHour.setHours(now.getHours() + 1, 0, 0, 0);
            
            const newBlock = {
                time: `${nextHour.getHours().toString().padStart(2, '0')}:00`,
                task: '',
                status: 'not-started'
            };
            
            data.plannerData[dateKey].timeBlocks.push(newBlock);
            saveData();
            renderTimeBlocks();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.timeBlockAdded, 'success');
        }

        function updateTimeBlockTask(index, task) {
            const dateKey = state.selectedPlannerDate;
            if (data.plannerData[dateKey]?.timeBlocks?.[index]) {
                data.plannerData[dateKey].timeBlocks[index].task = task;
                saveData();
            }
        }

        function toggleTimeBlockStatus(index) {
            const dateKey = state.selectedPlannerDate;
            if (!data.plannerData[dateKey]?.timeBlocks?.[index]) return;
            
            const block = data.plannerData[dateKey].timeBlocks[index];
            const statusOrder = ['not-started', 'in-progress', 'completed'];
            const currentIndex = statusOrder.indexOf(block.status);
            block.status = statusOrder[(currentIndex + 1) % statusOrder.length];
            
            saveData();
            renderTimeBlocks();
        }

        function deleteTimeBlock(index) {
            const dateKey = state.selectedPlannerDate;
            if (data.plannerData[dateKey]?.timeBlocks) {
                data.plannerData[dateKey].timeBlocks.splice(index, 1);
                saveData();
                renderTimeBlocks();
                
                const t = translations[settings.language] || translations.en;
                showToast(t.timeBlockRemoved, 'success');
            }
        }

        // ============================================
        // TIMER FUNCTIONS
        // ============================================

        function startTimer() {
            if (state.timerRunning) return;
            
            state.timerRunning = true;
            elements.startTimerBtn.disabled = true;
            elements.pauseTimerBtn.disabled = false;
            
            state.timerInterval = setInterval(() => {
                state.timerSeconds--;
                
                if (state.timerSeconds <= 0) {
                    timerComplete();
                    return;
                }
                
                updateTimerDisplay();
            }, 1000);
        }

        function pauseTimer() {
            if (!state.timerRunning) return;
            
            state.timerRunning = false;
            clearInterval(state.timerInterval);
            elements.startTimerBtn.disabled = false;
            elements.pauseTimerBtn.disabled = true;
        }

        function resetTimer() {
            pauseTimer();
            setTimer(25);
        }

        function setTimer(minutes) {
            state.timerSeconds = minutes * 60;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(state.timerSeconds / 60);
            const seconds = state.timerSeconds % 60;
            elements.timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function timerComplete() {
            pauseTimer();
            state.sessionsCompleted++;
            elements.sessionCount.textContent = state.sessionsCompleted;
            
            // Save session count
            localStorage.setItem('pomodoroSessions', state.sessionsCompleted.toString());
            
            // Show notification
            const t = translations[settings.language] || translations.en;
            showToast(t.timerComplete, 'success');
            
            // Reset timer for break
            setTimer(5);
        }

        // ============================================
        // MOTIVATION QUOTES
        // ============================================

        function loadMotivationQuote() {
            const lang = settings.language;
            const quotes = motivationQuotes[lang] || motivationQuotes.en;
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
            
            elements.motivationQuote.textContent = randomQuote.quote;
            elements.motivationAuthor.textContent = `- ${randomQuote.author}`;
        }

        // ============================================
        // FOCUS TOOLS FUNCTIONS
        // ============================================

        function loadHabits() {
            renderHabitsList();
        }

        function renderHabitsList() {
            elements.habitsList.innerHTML = '';
            
            if (data.habits.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.style.padding = '10px';
                emptyState.innerHTML = `
                    <i class="fas fa-walking"></i>
                    <p data-i18n="noHabits">No habits yet. Add your first habit!</p>
                `;
                elements.habitsList.appendChild(emptyState);
                return;
            }
            
            data.habits.forEach(habit => {
                const habitItem = createHabitItemElement(habit);
                elements.habitsList.appendChild(habitItem);
            });
        }

        function createHabitItemElement(habit) {
            const div = document.createElement('div');
            div.className = 'habit-item';
            div.dataset.habitId = habit.id;
            
            const nameDiv = document.createElement('div');
            nameDiv.className = 'habit-item-name';
            nameDiv.textContent = habit.name;
            nameDiv.addEventListener('click', () => openHabitEditModal(habit.id));
            
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'habit-item-actions';
            
            const deleteBtn = document.createElement('button');
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.title = 'Delete habit';
            deleteBtn.className = 'delete-btn';
            deleteBtn.addEventListener('click', () => deleteHabit(habit.id));
            
            actionsDiv.appendChild(deleteBtn);
            
            div.appendChild(nameDiv);
            div.appendChild(actionsDiv);
            
            return div;
        }

        function renderHabitTracker() {
            elements.habitTracker.innerHTML = '';
            
            // Day headers
            const t = translations[settings.language] || translations.en;
            for (let i = 0; i < 7; i++) {
                const dayDiv = document.createElement('div');
                dayDiv.className = 'habit-day';
                
                const dayName = document.createElement('span');
                dayName.textContent = t.days[i].substring(0, 1);
                dayName.style.fontSize = '12px';
                dayName.style.color = 'var(--text-secondary)';
                
                dayDiv.appendChild(dayName);
                elements.habitTracker.appendChild(dayDiv);
            }
            
            // Today's day of week (0 = Sunday, 6 = Saturday)
            const today = new Date().getDay();
            
            // Habit checkboxes for each day
            for (let i = 0; i < 7; i++) {
                const dayDiv = elements.habitTracker.children[i];
                
                // For each habit, add a checkbox for this day
                data.habits.forEach(habit => {
                    const checkbox = document.createElement('div');
                    checkbox.className = 'habit-checkbox';
                    
                    // Check if this habit should be tracked on this day
                    if (habit.checkedDays.includes(i)) {
                        // Check if habit is checked for today
                        const todayStr = new Date().toISOString().split('T')[0];
                        const habitKey = `habit_${habit.id}_${todayStr}`;
                        const isChecked = localStorage.getItem(habitKey) === 'true';
                        
                        if (isChecked) {
                            checkbox.classList.add('checked');
                            checkbox.innerHTML = '<i class="fas fa-check"></i>';
                        }
                        
                        // Only make today's checkbox clickable
                        if (i === today) {
                            checkbox.style.cursor = 'pointer';
                            checkbox.addEventListener('click', () => {
                                toggleHabitDay(habit.id, i);
                            });
                        } else {
                            checkbox.style.opacity = '0.5';
                        }
                    } else {
                        checkbox.style.opacity = '0.2';
                        checkbox.style.cursor = 'not-allowed';
                    }
                    
                    dayDiv.appendChild(checkbox);
                });
            }
        }

        function toggleHabitDay(habitId, day) {
            const today = new Date().getDay();
            if (day !== today) return; // Only allow toggling today
            
            const todayStr = new Date().toISOString().split('T')[0];
            const habitKey = `habit_${habitId}_${todayStr}`;
            const isChecked = localStorage.getItem(habitKey) === 'true';
            
            localStorage.setItem(habitKey, (!isChecked).toString());
            renderHabitTracker();
        }

        function addNewHabit() {
            const name = elements.newHabitInput.value.trim();
            if (!name) {
                const t = translations[settings.language] || translations.en;
                showToast(t.enterHabit, 'error');
                return;
            }
            
            const newHabit = {
                id: Date.now(),
                name: name,
                checkedDays: [1, 2, 3, 4, 5] // Default: Monday to Friday
            };
            
            data.habits.push(newHabit);
            saveData();
            
            elements.newHabitInput.value = '';
            renderHabitsList();
            renderHabitTracker();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.habitAdded, 'success');
        }

        function openHabitEditModal(habitId) {
            const habit = data.habits.find(h => h.id === habitId);
            if (!habit) return;
            
            state.editingHabitId = habitId;
            
            elements.editHabitName.value = habit.name;
            
            // Set up day buttons
            const dayButtons = elements.habitEditForm.querySelectorAll('.habit-day-btn');
            dayButtons.forEach(btn => {
                const day = parseInt(btn.dataset.day);
                btn.classList.toggle('active', habit.checkedDays.includes(day));
                
                btn.onclick = function() {
                    this.classList.toggle('active');
                };
            });
            
            elements.habitEditModal.style.display = 'flex';
        }

        function closeHabitEditModal() {
            elements.habitEditModal.style.display = 'none';
            state.editingHabitId = null;
        }

        function saveHabitEdit(e) {
            e.preventDefault();
            
            const habit = data.habits.find(h => h.id === state.editingHabitId);
            if (!habit) return;
            
            habit.name = elements.editHabitName.value.trim();
            
            // Get selected days
            const dayButtons = elements.habitEditForm.querySelectorAll('.habit-day-btn.active');
            habit.checkedDays = Array.from(dayButtons).map(btn => parseInt(btn.dataset.day));
            
            saveData();
            renderHabitsList();
            renderHabitTracker();
            closeHabitEditModal();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.habitUpdated, 'success');
        }

        function deleteHabit(habitId) {
            const t = translations[settings.language] || translations.en;
            if (!confirm(t.confirmDeleteHabit)) return;
            
            data.habits = data.habits.filter(h => h.id !== habitId);
            saveData();
            
            renderHabitsList();
            renderHabitTracker();
            
            showToast(t.habitDeleted, 'success');
        }

        function loadQuickNotes() {
            const savedNotes = localStorage.getItem('quickNotes');
            if (savedNotes) {
                data.quickNotesText = savedNotes;
                elements.quickNotes.value = savedNotes;
            }
        }

        function saveQuickNotes() {
            data.quickNotesText = elements.quickNotes.value;
            localStorage.setItem('quickNotes', data.quickNotesText);
            
            const t = translations[settings.language] || translations.en;
            showToast(t.notesSaved, 'success');
        }

        // ============================================
        // EISENHOWER MATRIX FUNCTIONS
        // ============================================

        function loadMatrixItems() {
            renderMatrixQuadrant(1);
            renderMatrixQuadrant(2);
            renderMatrixQuadrant(3);
            renderMatrixQuadrant(4);
        }

        function renderMatrixQuadrant(quadrant) {
            const quadrantEl = document.getElementById(`quadrant${quadrant}`);
            const countEl = document.getElementById(`quadrant${quadrant}-count`);
            
            if (!quadrantEl || !countEl) return;
            
            quadrantEl.innerHTML = '';
            const items = data.matrixItems[quadrant] || [];
            countEl.textContent = items.length;
            
            items.forEach((item, index) => {
                const itemEl = createMatrixItemElement(item, quadrant, index);
                quadrantEl.appendChild(itemEl);
            });
        }

        function createMatrixItemElement(item, quadrant, index) {
            const div = document.createElement('div');
            div.className = 'matrix-item';
            div.draggable = true;
            div.dataset.itemId = item.id;
            div.dataset.quadrant = quadrant;
            
            div.addEventListener('dragstart', handleDragStart);
            div.addEventListener('dragover', handleDragOver);
            div.addEventListener('drop', handleDrop);
            div.addEventListener('dragend', handleDragEnd);
            
            const textDiv = document.createElement('div');
            textDiv.className = 'matrix-item-text';
            textDiv.textContent = item.text;
            textDiv.addEventListener('click', () => {
                editMatrixItem(item.id, quadrant);
            });
            
            const actionsDiv = document.createElement('div');
            actionsDiv.className = 'matrix-item-actions';
            
            const deleteBtn = document.createElement('button');
            deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
            deleteBtn.title = 'Delete item';
            deleteBtn.className = 'delete-btn';
            deleteBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                deleteMatrixItem(item.id, quadrant);
            });
            
            actionsDiv.appendChild(deleteBtn);
            
            div.appendChild(textDiv);
            div.appendChild(actionsDiv);
            
            return div;
        }

        function addMatrixItem(quadrant, text) {
            const trimmedText = text.trim();
            if (!trimmedText) {
                const t = translations[settings.language] || translations.en;
                showToast(t.enterMatrixItem, 'error');
                return;
            }
            
            const newItem = {
                id: Date.now(),
                text: trimmedText
            };
            
            data.matrixItems[quadrant].push(newItem);
            saveData();
            renderMatrixQuadrant(quadrant);
            
            const t = translations[settings.language] || translations.en;
            showToast(t.matrixItemAdded, 'success');
        }

        function editMatrixItem(itemId, quadrant) {
            const items = data.matrixItems[quadrant];
            const item = items.find(i => i.id === itemId);
            if (!item) return;
            
            const newText = prompt('Edit item:', item.text);
            if (newText !== null) {
                item.text = newText.trim();
                saveData();
                renderMatrixQuadrant(quadrant);
            }
        }

        function deleteMatrixItem(itemId, quadrant) {
            const t = translations[settings.language] || translations.en;
            if (!confirm(t.confirmDeleteMatrixItem)) return;
            
            data.matrixItems[quadrant] = data.matrixItems[quadrant].filter(i => i.id !== itemId);
            saveData();
            renderMatrixQuadrant(quadrant);
            
            showToast(t.matrixItemDeleted, 'success');
        }

        function setupMatrixDragAndDrop() {
            // Event handlers are attached to individual items in createMatrixItemElement
        }

        function handleDragStart(e) {
            state.draggingMatrixItem = {
                id: parseInt(e.target.dataset.itemId),
                quadrant: parseInt(e.target.dataset.quadrant)
            };
            e.dataTransfer.effectAllowed = 'move';
            setTimeout(() => {
                e.target.style.opacity = '0.4';
            }, 0);
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            return false;
        }

        function handleDrop(e) {
            e.preventDefault();
            
            if (!state.draggingMatrixItem) return;
            
            const targetQuadrant = parseInt(e.target.closest('.matrix-items').dataset.quadrant);
            const sourceQuadrant = state.draggingMatrixItem.quadrant;
            
            if (sourceQuadrant !== targetQuadrant) {
                // Move item to different quadrant
                const sourceItems = data.matrixItems[sourceQuadrant];
                const itemIndex = sourceItems.findIndex(i => i.id === state.draggingMatrixItem.id);
                
                if (itemIndex !== -1) {
                    const [item] = sourceItems.splice(itemIndex, 1);
                    data.matrixItems[targetQuadrant].push(item);
                    saveData();
                    
                    renderMatrixQuadrant(sourceQuadrant);
                    renderMatrixQuadrant(targetQuadrant);
                }
            }
            
            return false;
        }

        function handleDragEnd(e) {
            e.target.style.opacity = '1';
            state.draggingMatrixItem = null;
        }

        // ============================================
        // DATA EXPORT/IMPORT
        // ============================================

        function exportData() {
            const exportData = {
                tasks: data.tasks,
                projects: data.projects,
                calendarEvents: data.calendarEvents,
                plannerData: data.plannerData,
                habits: data.habits,
                matrixItems: data.matrixItems,
                settings: settings,
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `productivity-pro-backup-${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            const t = translations[settings.language] || translations.en;
            showToast(t.exportSuccess, 'success');
        }

        function importData(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Validate imported data
                    if (!importedData.version) {
                        throw new Error('Invalid backup file format');
                    }
                    
                    // Import data
                    if (importedData.tasks) data.tasks = importedData.tasks;
                    if (importedData.projects) data.projects = importedData.projects;
                    if (importedData.calendarEvents) data.calendarEvents = importedData.calendarEvents;
                    if (importedData.plannerData) data.plannerData = importedData.plannerData;
                    if (importedData.habits) data.habits = importedData.habits;
                    if (importedData.matrixItems) data.matrixItems = importedData.matrixItems;
                    
                    // Import settings if available
                    if (importedData.settings) {
                        if (importedData.settings.language) settings.language = importedData.settings.language;
                        if (importedData.settings.theme) settings.theme = importedData.settings.theme;
                        if (importedData.settings.viewMode) settings.viewMode = importedData.settings.viewMode;
                        saveSettings();
                        applySettings();
                    }
                    
                    saveData();
                    
                    // Refresh UI
                    updateTodoList();
                    updateProjectsGrid();
                    loadCalendarEvents();
                    renderCalendar();
                    loadPlannerData();
                    loadHabits();
                    renderHabitTracker();
                    loadMatrixItems();
                    
                    // Reset file input
                    elements.importFileInput.value = '';
                    
                    const t = translations[settings.language] || translations.en;
                    showToast(t.importSuccess, 'success');
                    
                } catch (error) {
                    console.error('Error importing data:', error);
                    const t = translations[settings.language] || translations.en;
                    showToast(t.importError, 'error');
                }
            };
            
            reader.readAsText(file);
        }

        function clearAllData() {
            const t = translations[settings.language] || translations.en;
            if (!confirm(t.confirmClear)) return;
            
            // Clear all data
            data.tasks = [];
            data.projects = [];
            data.calendarEvents = [];
            data.plannerData = {};
            data.habits = [];
            data.matrixItems = { '1': [], '2': [], '3': [], '4': [] };
            
            // Clear timer sessions
            state.sessionsCompleted = 0;
            localStorage.removeItem('pomodoroSessions');
            
            // Reset task counter
            state.taskCounter = 1;
            
            saveData();
            
            // Reset UI
            updateTodoList();
            updateProjectsGrid();
            loadCalendarEvents();
            renderCalendar();
            loadPlannerData();
            loadHabits();
            renderHabitTracker();
            loadMatrixItems();
            updateDashboardCounters();
            
            // Reset timer display
            resetTimer();
            
            showToast(t.dataCleared, 'success');
        }

        // ============================================
        // INITIALIZE APP
        // ============================================

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);

        // Make some functions globally available for inline event handlers
        window.toggleTaskComplete = toggleTaskComplete;
    </script>
</body>
</html>